<aside id="rightSidebar" class="navbar-right">
  <div class="button-container">
    <button
      class="btn btn-info btn-outline btn-sm w-100 m-0"
      mat-raised-button
      matTooltip="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.APPLY_CHANGES' | translate }}"
      [ngClass]="form_data.viz_type != undefined || stateloadDataset ? '' : '  disabled'"
      (click)="runQuery(visualType)"
    >
      <div class="loader loader--style1" title="0" *ngIf="isLoadingContent">
        <svg
          version="1.1"
          id="loader-1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          x="0px"
          y="0px"
          width="15px"
          height="15px"
          viewBox="0 0 40 45"
          enable-background="new 0 0 40 40"
          xml:space="preserve"
        >
          <path
            opacity="0.2"
            fill="#000"
            d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946
  s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634
  c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z"
          />
          <path
            fill="#000"
            d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0
  C22.32,8.481,24.301,9.057,26.013,10.047z"
          >
            <animateTransform
              attributeType="xml"
              attributeName="transform"
              type="rotate"
              from="0 20 20"
              to="360 20 20"
              dur="0.5s"
              repeatCount="indefinite"
            />
          </path>
        </svg>
      </div>
      &nbsp; {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.APPLY_CHANGES' | translate }}
      <i class="zmdi zmdi-play f-12 ml-1"></i>
    </button>
  </div>

  <div class="panel-group m-0 dp-h93v" id="accordion_1" role="tablist" aria-multiselectable="true">
    <!-- Datasource  -->
    <div class="panel panel-primary m-0">
      <div class="panel-heading" role="tab" id="headingOne_1">
        <h4 class="panel-title">
          <a
            [ngClass]="{ toggled: activeColapse.datasource == true }"
            class="menu-toggle text-uppercase"
            role="button"
            (click)="collapseOnClick('datasource')"
          >
            <i
              class="zmdi zmdi-info"
              data-toggle="popover"
              data-placement="bottom"
              [attr.data-original-title]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.DATASOURCE' | translate"
              [attr.data-content]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.DATASOURCE_TOOLTIP' | translate"
            ></i
            >&nbsp;
            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.DATASOURCE' | translate }}
          </a>
        </h4>
      </div>
      <div [ngClass]="{ show: activeColapse.datasource == true }" class="panel-collapse collapse" role="tabpanel">
        <div class="panel-body">
          <div class="row clearfix">
            <div class="col-sm-12 form-control-label">
              <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.DATASOURCE' | translate }}</label>
            </div>
            <div class="col-sm-12">
              <div class="form-group">
                <div class="form-line">
                  <ng-select
                    [items]="datasetList"
                    [multiple]="false"
                    [closeOnSelect]="true"
                    [searchable]="true"
                    bindLabel="query"
                    (change)="loadDatasetToProps($event)"
                    (remove)="buttonNew()"
                    [(ngModel)]="queryName"
                    [ngModelOptions]="{ standalone: true }"
                    [disabled]="slice?.slice_id > 0 && slice?.slice_id != undefined ? false : true"
                    placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} {{
                      'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.DT' | translate
                    }}"
                  >
                    <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                      <div class="ng-value" *ngFor="let item of items">
                        <span class="ng-value-label"> {{ item.query }}</span>
                      </div>
                    </ng-template>
                  </ng-select>
                </div>
              </div>
            </div>
          </div>

          <div class="row clearfix">
            <div class="col-sm-12 form-control-label">
              <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.DT' | translate }}</label>
            </div>
            <div class="col-sm-12">
              <div class="form-group">
                <div class="form-line">
                  <input type="text" class="form-control" [(ngModel)]="datasetName" />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Visualization Type  -->
    <div class="panel panel-primary m-0">
      <div class="panel-heading" role="tab" id="headingSix_1">
        <h4 class="panel-title">
          <a
            [ngClass]="{ toggled: activeColapse.visualization == true }"
            class="menu-toggle collapsed text-uppercase"
            role="button"
            (click)="collapseOnClick('visualization')"
          >
            <i
              class="zmdi zmdi-info"
              data-toggle="popover"
              data-placement="bottom"
              [attr.data-original-title]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.VISUALIZATION_TYPE' | translate"
              [attr.data-content]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.VISUALIZATION_TYPE_TOOLTIP' | translate"
            ></i
            >&nbsp;
            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.VISUALIZATION_TYPE' | translate }}
          </a>
        </h4>
      </div>
      <div
        [ngClass]="{ show: activeColapse.visualization == true }"
        class="panel-collapse collapse show"
        role="tabpanel"
      >
        <div class="panel-body text-justify">
          <label for="choose_ds" class="choose_vs">
            <div class="flex-fill bd-highlight">
              <small class="text-muted">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.SELECTED_TYPE' | translate }}:</small>
              <br />
              <h6 class="mb-0">{{ visualName || '' }}</h6>
            </div>
          </label>
          <div class="row clearfix pl-1" *ngIf="listVs.length > 0">
            <button
              *ngFor="let row of listVs[0].visual_type"
              [ngStyle]="{ display: row.display }"
              (click)="setVisualType(row)"
              [ngClass]="{ active: displaySelected == row.value, 'd-none': row.value == 'osmmap' }"
              class="btn btn-info btn-outline btn-icon btn-outline-maxi mx-2"
              mat-raised-button
              matTooltip="{{ row.label }}"
            >
              <span><img [src]="handleIcon(row)" /></span>
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- Chart Query  -->
    <!-- Chart Query  -->
    <div class="panel panel-primary m-0" *ngIf="!['markup'].includes(visualType)">
      <div class="panel-heading" role="tab" id="headingTwo_1">
        <h4 class="panel-title">
          <a
            [ngClass]="{ toggled: activeColapse.query == true }"
            class="menu-toggle collapsed text-uppercase"
            role="button"
            (click)="collapseOnClick('query')"
            ><i
              class="zmdi zmdi-info"
              data-toggle="popover"
              data-placement="bottom"
              [attr.data-original-title]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.LABEL' | translate"
              [attr.data-content]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.LABEL_TOOLTIP' | translate"
            ></i
            >&nbsp;
            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.LABEL' | translate }}
          </a>
        </h4>
      </div>
      <div [ngClass]="{ show: activeColapse.query == true }" class="panel-collapse collapse" role="tabpanel">
        <div class="panel-body">
          <!-- TABLE  & PIVOT TABLE-->
          <div class="form-horizontal" *ngIf="['pivot_table', 'table'].includes(visualType)">
            <div class="row clearfix">
              <div class="col-lg-12 col-md-12 col-sm-6 form-control-label">
                <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.TT' | translate }} <font color="red"></font></label>
              </div>
              <div class="col-lg-12 col-md-12 col-sm-6">
                <div class="form-group">
                  <select
                    name="viz_type"
                    [(ngModel)]="form_data.viz_type"
                    (change)="onOptionsSelected(form_data.viz_type)"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SMT' | translate"
                    [ngClass]="form_data.viz_type == '' ? 'require-error is-invalid' : ''"
                    required
                  >
                    <option value="table">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.T' | translate }}</option>
                    <option value="pivot_table">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.PT' | translate }}</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-horizontal" *ngIf="form_data.viz_type == 'table'">
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label">
                  <label for="last_run">Group By <font color="red">*</font></label>
                </div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <ng-select
                        *ngIf="chartLinks"
                        class="text-light"
                        [items]="chartLinks?.datasource?.gb_cols | keyvals"
                        [multiple]="true"
                        [closeOnSelect]="true"
                        [searchable]="true"
                        [hideSelected]="true"
                        bindLabel="value"
                        bindValue="value"
                        placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SG' | translate }}"
                        name="groupby"
                        [(ngModel)]="form_data.groupby"
                        [ngClass]="form_data.groupby == '' ? 'require-error is-invalid' : ''"
                        required
                      >
                        <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                          <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                            <span class="ng-value-label" id="{{ item['key'] }}"> {{ item['value'] }}</span>
                            <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                          </div>
                          <div class="ng-value" *ngIf="items.length > 4">
                            <span class="ng-value-label"
                              >{{ items.length - 4 }}
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                            >
                          </div>
                        </ng-template>
                      </ng-select>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label">
                  <label for="last_run">Value <font color="red">*</font></label>
                  <button
                    *ngIf="chartLinks"
                    [ngStyle]="{ float: 'right' }"
                    type="button"
                    class="btn btn-info btn-outline btn-sm m-0 mb-3"
                    (click)="openModalTemplateCustom('saveCharts')"
                  >
                    {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                    <i class="zmdi zmdi-plus f-12 ml-1"></i>
                  </button>
                </div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <ng-select
                        *ngIf="chartLinks"
                        class="text-light"
                        [items]="chartLinks?.datasource?.metrics"
                        [multiple]="true"
                        [closeOnSelect]="true"
                        [searchable]="true"
                        [hideSelected]="true"
                        bindLabel="verbose_name"
                        bindValue="metric_name"
                        placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                        name="metrics"
                        [(ngModel)]="form_data.metrics"
                        [ngClass]="form_data.metrics == '' ? 'require-error is-invalid' : ''"
                        required
                      >
                        <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                          <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                            <span class="ng-value-label" (click)="showFormula(item, 'e')">
                              {{ item['verbose_name'] }}</span
                            >
                            <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                          </div>
                          <div class="ng-value" *ngIf="items.length > 4">
                            <span class="ng-value-label"
                              >{{ items.length - 4 }}
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                            >
                          </div>
                        </ng-template>
                      </ng-select>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label"></div>
                <div class="col-sm-12">
                  <div class="form-line">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="include_time"
                        name="include_time"
                        [(ngModel)]="form_data.include_time"
                        type="checkbox"
                        [innerHTML]="include_time ? 'checked' : ''"
                      />
                      <label for="include_time">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.IT' | translate }}</label>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row clearfix">
                <div class="col-lg-12 form-control-label">
                  <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SORT_BY' | translate }}</label>
                </div>
                <div class="row">
                  <div class="col-sm-12">
                    <div class="form-line">
                      <div class="pl-2">
                        <mat-radio-group
                          aria-labelledby="radio-group-label"
                          class="radio-group-choose-colorpicker radio-group mt-0 mb-0"
                          name="sort_aggregate_column"
                          [(ngModel)]="form_data.sort_aggregate_column"
                          required
                        >
                          <div class="row">
                            <div class="col-lg-6">
                              <mat-radio-button class="radio-button" value="option1"> Aggregate </mat-radio-button>
                            </div>
                            <div class="col-lg-6">
                              <mat-radio-button class="radio-button" value="option2"> Column </mat-radio-button>
                            </div>
                          </div>
                        </mat-radio-group>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div *ngIf="form_data.sort_aggregate_column == 'option1'" class="row clearfix">
                <div class="col-sm-12 form-control-label">
                  <label for="last_run"> {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SBA' | translate }}</label>
                </div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <select
                        *ngIf="chartLinks"
                        class="form-control show-tick ms select2"
                        [attr.placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                        name="timeseries_limit_metric"
                        [(ngModel)]="form_data.timeseries_limit_metric"
                      >
                        <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                        <option *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvals" [value]="row.value">
                          {{ row.value }}
                        </option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="col-sm-12 form-control-label"></div>
                <div class="col-sm-12">
                  <div class="checkbox" *ngIf="chartLinks">
                    <input
                      id="order_desc"
                      name="order_desc"
                      [(ngModel)]="form_data.order_desc"
                      type="checkbox"
                      [innerHTML]="order_desc ? 'checked' : ''"
                    />
                    <label for="order_desc">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SBD' | translate }}</label>
                  </div>
                </div>
              </div>

              <div *ngIf="form_data.sort_aggregate_column == 'option2'" class="row clearfix">
                <div class="col-sm-12">
                  <div class="form-group">
                    <label for="last_run"> {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SBC' | translate }}</label>
                    <div class="form-line">
                      <select
                        *ngIf="chartLinks"
                        class="form-control show-tick ms select2"
                        [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                        [(ngModel)]="form_data.table_filter_column"
                        name="table_column"
                      >
                        <option [value]="">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                        <option *ngFor="let row of chartLinks?.datasource?.columns" [value]="row.column_name">
                          {{ row.column_name }}
                        </option>
                      </select>
                    </div>
                  </div>
                  <div class="form-group">
                    <div class="form-line">
                      <div class="checkbox">
                        <input
                          [(ngModel)]="form_data.table_sort_desc"
                          name="table_sort_desc"
                          id="table_sort_desc"
                          type="checkbox"
                        />
                        <label for="table_sort_desc">{{
                          'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SBD' | translate
                        }}</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <hr />
              <div class="row clearfix">
                <div class="col-lg-12 form-control-label">
                  <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.NGBO' | translate }}</label>
                </div>
                <div class="col-lg-12">
                  <div class="form-group">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light lh-12"
                      [items]="chartLinks?.datasource?.columns"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="column_name"
                      bindValue="column_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate }}"
                      name="order_by_cols"
                      [(ngModel)]="form_data.order_by_cols"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label"> {{ item['column_name'] }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>

              <div class="row clearfix">
                <div class="col-sm-12 form-control-label">
                  <label for="last_run">
                    {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.NGBC' | translate }} <font color="red">*</font></label
                  >
                </div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <ng-select
                        *ngIf="chartLinks"
                        class="text-light"
                        [items]="chartLinks?.datasource?.columns"
                        [multiple]="true"
                        [closeOnSelect]="true"
                        [searchable]="true"
                        [hideSelected]="true"
                        bindLabel="column_name"
                        bindValue="column_name"
                        placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate }}"
                        name="all_columns"
                        [(ngModel)]="form_data.all_columns"
                      >
                        <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                          <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                            <span class="ng-value-label"> {{ item['column_name'] }}</span>
                            <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                          </div>
                          <div class="ng-value" *ngIf="items.length > 4">
                            <span class="ng-value-label"
                              >{{ items.length - 4 }}
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                            >
                          </div>
                        </ng-template>
                      </ng-select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- PIVOT TABLE  -->
            <div class="form-horizontal" *ngIf="form_data.viz_type == 'pivot_table'">
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label">
                  <label for="last_run"
                    >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.G' | translate }}
                    <font color="red">*</font>
                  </label>
                </div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <ng-select
                        *ngIf="chartLinks"
                        class="text-light"
                        [items]="chartLinks?.datasource?.gb_cols | keyvals"
                        [multiple]="true"
                        [closeOnSelect]="true"
                        [searchable]="true"
                        [hideSelected]="true"
                        bindLabel="value"
                        bindValue="value"
                        placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate }}"
                        name="groupby"
                        [(ngModel)]="form_data.groupby"
                        [ngClass]="form_data.groupby == '' ? 'require-error is-invalid' : ''"
                        required
                      >
                        <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                          <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                            <span class="ng-value-label" id="{{ item['key'] }}"> {{ item['value'] }}</span>
                            <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                          </div>
                          <div class="ng-value" *ngIf="items.length > 4">
                            <span class="ng-value-label"
                              >{{ items.length - 4 }}
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                            >
                          </div>
                        </ng-template>
                      </ng-select>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label">
                  <label for="last_run"
                    >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                  >
                  <button
                    *ngIf="chartLinks"
                    [ngStyle]="{ float: 'right' }"
                    type="button"
                    class="btn btn-info btn-outline btn-sm m-0 mb-3"
                    (click)="openModalTemplateCustom('formulaModal')"
                  >
                    {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                    <i class="zmdi zmdi-plus f-12 ml-1"></i>
                  </button>
                </div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <ng-select
                        *ngIf="chartLinks"
                        class="text-light"
                        [items]="chartLinks?.datasource?.metrics"
                        [multiple]="true"
                        [closeOnSelect]="true"
                        [searchable]="true"
                        [hideSelected]="true"
                        bindLabel="verbose_name"
                        bindValue="metric_name"
                        placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                        name="metrics"
                        [(ngModel)]="form_data.metrics"
                        [ngClass]="form_data.metrics == '' ? 'require-error is-invalid' : ''"
                        required
                      >
                        <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                          <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                            <span class="ng-value-label"> {{ item['verbose_name'] }}</span>
                            <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                          </div>
                          <div class="ng-value" *ngIf="items.length > 4">
                            <span class="ng-value-label"
                              >{{ items.length - 4 }}
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                            >
                          </div>
                        </ng-template>
                      </ng-select>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label">
                  <label for="last_run"
                    >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.COL' | translate }}
                    <font color="red">*</font>
                  </label>
                </div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <div class="form-line">
                        <ng-select
                          *ngIf="chartLinks"
                          class="text-light"
                          [items]="chartLinks?.datasource?.gb_cols | keyvals"
                          [multiple]="true"
                          [closeOnSelect]="true"
                          [searchable]="true"
                          [hideSelected]="true"
                          bindLabel="value"
                          bindValue="value"
                          placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SC' | translate }}"
                          name="columns"
                          [(ngModel)]="form_data.columns"
                        >
                          <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                            <div class="ng-value" *ngFor="let item of items | slice: 0:2">
                              <span class="ng-value-label" id="{{ item['key'] }}"> {{ item['value'] }}</span>
                              <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                            </div>
                            <div class="ng-value" *ngIf="items.length > 4">
                              <span class="ng-value-label"
                                >{{ items.length - 4 }}
                                {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                              >
                            </div>
                          </ng-template>
                        </ng-select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- TABLE COMPARISON  -->
          <div class="form-horizontal" *ngIf="visualType == 'table_comparison'">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.G' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.gb_cols | keyvals"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SG' | translate }}"
                      name="groupby"
                      [(ngModel)]="form_data.groupby"
                      [ngClass]="form_data.groupby == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['key'] }}">
                            {{ item['value'] }}
                          </span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12">
                <div class="form-group">
                  <button
                    type="button"
                    class="btn btn-info btn-outline btn-sm w-100 m-0"
                    (click)="openModalTemplateCustom('modalComparison')"
                  >
                    {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.AD' | translate }}
                    <i class="zmdi zmdi-plus f-12 ml-1"></i>
                  </button>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12">
                <div class="form-group">
                  <button
                    type="button"
                    class="btn btn-info btn-outline btn-sm w-100 m-0"
                    (click)="openModalTemplateCustom('modalCustomColumnFormat')"
                  >
                    {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.ACF' | translate }}
                    <i class="zmdi zmdi-plus f-12 ml-1"></i>
                  </button>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="format_number_id"
                        name="format_number_id"
                        [(ngModel)]="form_data.format_number_id"
                        type="checkbox"
                        checked=""
                        [innerHTML]="format_number_id ? 'checked' : ''"
                      />
                      <label for="format_number_id">{{
                        'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.FID' | translate
                      }}</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- PIE  -->
          <div class="form-horizontal" *ngIf="visualType == 'pie'">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.G' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.gb_cols | keyvals"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SG' | translate }}"
                      name="groupby"
                      [(ngModel)]="form_data.groupby"
                      [ngClass]="form_data.groupby == '' ? 'require-error is-invalid' : ''"
                      required
                      (add)="remappingColorpicker('', data_exploreJson)"
                      (clear)="remappingColorpicker('', data_exploreJson)"
                      (remove)="remappingColorpicker('', data_exploreJson)"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['key'] }}">
                            {{ item['value'] }}
                          </span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                >
                <button
                  *ngIf="chartLinks"
                  [ngStyle]="{ float: 'right' }"
                  type="button"
                  class="btn btn-info btn-outline btn-sm m-0 mb-3"
                  (click)="openModalTemplateCustom('formulaModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.metrics"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="verbose_name"
                      bindValue="metric_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                      name="metrics"
                      [(ngModel)]="form_data.metrics"
                      [ngClass]="form_data.metrics == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" (click)="showFormula(item, 'e')">
                            {{ item['verbose_name'] }}</span
                          >
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-lg-12 form-control-label">
                <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.EL' | translate }}</label>
              </div>
              <div class="col-lg-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.limit"
                      name="limit"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CL' | translate }}</option>
                      <option *ngFor="let row of list_row_limit | keyvalue" [value]="row.value[1]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.TOOLTIP' | translate }} </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.filterable_cols | keyvals"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.ST' | translate }}"
                      name="tooltips"
                      [(ngModel)]="form_data.tooltips"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['key'] }}"> {{ item['value'] }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- BAR  -->
          <div class="form-horizontal" *ngIf="['horizontal_bar', 'dist_bar'].includes(visualType)">
            <div class="row clearfix">
              <div class="col-lg-12 col-md-12 col-sm-6 form-control-label">
                <label
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.TBC' | translate }} <font color="red"></font
                ></label>
              </div>
              <div class="col-lg-12 col-md-12 col-sm-6">
                <div class="form-group">
                  <select
                    name="viz_type"
                    [(ngModel)]="form_data.viz_type"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SMT' | translate"
                    [ngClass]="form_data.viz_type == '' ? 'require-error is-invalid' : ''"
                    (change)="runQuery(form_data.viz_type)"
                    required
                  >
                    <option value="dist_bar">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.VBC' | translate }}</option>
                    <option value="horizontal_bar">
                      {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.HBC' | translate }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                >
                <button
                  *ngIf="chartLinks"
                  [ngStyle]="{ float: 'right' }"
                  type="button"
                  class="btn btn-info btn-outline btn-sm m-0 mb-3"
                  (click)="openModalTemplateCustom('formulaModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.metrics"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="verbose_name"
                      bindValue="metric_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                      name="metrics"
                      [(ngModel)]="form_data.metrics"
                      [ngClass]="form_data.metrics == '' ? 'require-error is-invalid' : ''"
                      required
                      (add)="remappingColorpicker('', data_exploreJson)"
                      (clear)="remappingColorpicker('', data_exploreJson)"
                      (remove)="remappingColorpicker('', data_exploreJson)"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" (click)="showFormula(item, 'e')">
                            {{ item['verbose_name'] }}</span
                          >
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.G' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.gb_cols | keyvals"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SG' | translate }}"
                      name="groupby"
                      [(ngModel)]="form_data.groupby"
                      [ngClass]="form_data.groupby == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['key'] }}">
                            {{ item['value'] }}
                          </span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SUBG' | translate }}</label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.filterable_cols | keyvals"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate }}"
                      name="columns"
                      [(ngModel)]="form_data.columns"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['key'] }}"> {{ item['value'] }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-lg-12 form-control-label">
                <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.RL' | translate }}</label>
              </div>
              <div class="col-lg-12">
                <div class="form-group">
                  <select
                    *ngIf="chartLinks"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                    [(ngModel)]="form_data.row_limit"
                    name="row_limit"
                  >
                    <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CL' | translate }}</option>
                    <option *ngFor="let row of list_row_limit | keyvalue" [value]="row.value[0]">
                      {{ row.value[0] }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.TOOLTIP' | translate }} </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.filterable_cols | keyvals"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.ST' | translate }}"
                      name="tooltips"
                      [(ngModel)]="form_data.tooltips"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['key'] }}"> {{ item['value'] }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <!-- BAR LINE  -->
            <div *ngIf="form_data.viz_type == 'dist_bar'" class="row clearfix">
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input [(ngModel)]="form_data.with_line" name="with_line" id="with_line" type="checkbox" />
                      <label for="with_line">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.WLC' | translate }} </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix" *ngIf="form_data?.with_line">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.LM' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.line_metric"
                      name="line_metric"
                      [ngClass]="form_data.line_metric == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CV' | translate }}</option>
                      <option *ngFor="let row of chartLinks?.datasource?.metrics" [value]="row.metric_name">
                        {{ row.verbose_name }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix" *ngIf="form_data?.with_line">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.LC' | translate }} </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <input
                      *ngIf="chartLinks"
                      class="form-control show-tick ms"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.IN_NC' | translate"
                      [(ngModel)]="form_data.line_const"
                      name="line_const"
                      inputNumber
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Heatmap-->
          <div class="form-horizontal" *ngIf="['heatmap'].includes(visualType)">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                >
                <button
                  *ngIf="chartLinks"
                  [ngStyle]="{ float: 'right' }"
                  type="button"
                  class="btn btn-info btn-outline btn-sm m-0 mb-3"
                  (click)="openModalTemplateCustom('formulaModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.metrics"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="verbose_name"
                      bindValue="metric_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                      name="metrics"
                      [(ngModel)]="form_data.heat_map.metric_heat_map"
                      (add)="remappingColorpicker('', data_exploreJson)"
                      (clear)="remappingColorpicker('', data_exploreJson)"
                      (remove)="remappingColorpicker('', data_exploreJson)"
                      [ngClass]="form_data.heat_map.metric_heat_map == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" (click)="showFormula(item, 'e')">
                            {{ item['verbose_name'] }}</span
                          >
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <!-- HEATMAP PROPS -->
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.FX' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.filterable_cols | keyvals"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.FX' | translate }}"
                      name="columns"
                      [(ngModel)]="form_data.heat_map.x_heat_map"
                      [ngClass]="form_data.heat_map.x_heat_map == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['key'] }}"> {{ item['value'] }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.FY' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.filterable_cols | keyvals"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.FY' | translate }}"
                      name="columns"
                      [(ngModel)]="form_data.heat_map.y_heat_map"
                      [ngClass]="form_data.heat_map.y_heat_map == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['key'] }}"> {{ item['value'] }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label"></div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="sort_asc_x"
                        name="sort_asc_x"
                        [(ngModel)]="form_data.heat_map.sort_asc_x"
                        type="checkbox"
                        [innerHTML]="sort_asc_x ? 'checked' : ''"
                      />
                      <label for="sort_asc_x">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SX' | translate }}</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label"></div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="sort_asc_y"
                        name="sort_asc_y"
                        [(ngModel)]="form_data.heat_map.sort_asc_y"
                        type="checkbox"
                        [innerHTML]="sort_asc_y ? 'checked' : ''"
                      />
                      <label for="sort_asc_y">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SY' | translate }}</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-lg-12 form-control-label">
                <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.RLX' | translate }}</label>
              </div>
              <div class="col-lg-12">
                <div class="form-group">
                  <select
                    *ngIf="chartLinks"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                    [(ngModel)]="form_data.heat_map.limit_x"
                    name="limit_x"
                  >
                    <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CL' | translate }}</option>
                    <option *ngFor="let row of list_row_limit | keyvalue" [value]="row.value[0]">
                      {{ row.value[0] }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-lg-12 form-control-label">
                <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.RLY' | translate }}</label>
              </div>
              <div class="col-lg-12">
                <div class="form-group">
                  <select
                    *ngIf="chartLinks"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                    [(ngModel)]="form_data.heat_map.limit_y"
                    name="limit_y"
                  >
                    <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CL' | translate }}</option>
                    <option *ngFor="let row of list_row_limit | keyvalue" [value]="row.value[0]">
                      {{ row.value[0] }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
          </div>
          <!-- Wordcloud  -->
          <div class="form-horizontal" *ngIf="visualType == 'word_cloud'">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.G' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.gb_cols | keyvals"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SG' | translate }}"
                      name="series"
                      [(ngModel)]="form_data.series"
                      [ngClass]="form_data.series == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['key'] }}">
                            {{ item['value'] }}
                          </span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                >
                <button
                  *ngIf="chartLinks"
                  [ngStyle]="{ float: 'right' }"
                  type="button"
                  class="btn btn-info btn-outline btn-sm m-0 mb-3"
                  (click)="openModalTemplateCustom('formulaModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.metrics"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="verbose_name"
                      bindValue="metric_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                      name="metric"
                      [(ngModel)]="form_data.metric"
                      [ngClass]="form_data.metric == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" (click)="showFormula(item, 'e')">
                            {{ item['verbose_name'] }}</span
                          >
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-lg-12 form-control-label">
                <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.EL' | translate }}</label>
              </div>
              <div class="col-lg-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.row_limit"
                      name="row_limit"
                      placeholder="row_limit"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CL' | translate }}</option>
                      <option *ngFor="let row of list_row_limit | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Line Charts -->
          <div class="form-horizontal" *ngIf="['line', 'dual_line'].includes(visualType)">
            <div class="row clearfix">
              <div class="col-lg-12 col-md-12 col-sm-6 form-control-label">
                <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.TC' | translate }} <font color="red"></font></label>
              </div>
              <div class="col-lg-12 col-md-12 col-sm-6">
                <div class="form-group">
                  <select
                    name="viz_type"
                    [(ngModel)]="form_data.viz_type"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SCT' | translate"
                    [ngClass]="form_data.viz_type == '' ? 'require-error is-invalid' : ''"
                    (change)="runQuery(form_data.viz_type)"
                    required
                  >
                    <option value="line">
                      {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.LINE_CHART' | translate }}
                    </option>
                    <option value="dual_line">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.DLA' | translate }}</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-horizontal" *ngIf="form_data.viz_type == 'line'">
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.G' | translate }}</label>
                </div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <ng-select
                        *ngIf="chartLinks"
                        class="text-light"
                        [items]="chartLinks?.datasource?.gb_cols | keyvals"
                        [multiple]="true"
                        [closeOnSelect]="true"
                        [searchable]="true"
                        [hideSelected]="true"
                        bindLabel="value"
                        bindValue="value"
                        placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SG' | translate }}"
                        name="groupby"
                        [(ngModel)]="form_data.groupby"
                        (add)="remappingColorpicker('', data_exploreJson)"
                        (clear)="remappingColorpicker('', data_exploreJson)"
                        (remove)="remappingColorpicker('', data_exploreJson)"
                      >
                        <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                          <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                            <span class="ng-value-label" id="{{ item['key'] }}"> {{ item['value'] }}</span>
                            <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                          </div>
                          <div class="ng-value" *ngIf="items.length > 4">
                            <span class="ng-value-label">{{ items.length - 4 }} more...</span>
                          </div>
                        </ng-template>
                      </ng-select>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label">
                  <label for="last_run"
                    >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                  >
                  <button
                    *ngIf="chartLinks"
                    [ngStyle]="{ float: 'right' }"
                    type="button"
                    class="btn btn-info btn-outline btn-sm m-0 mb-3"
                    (click)="openModalTemplateCustom('formulaModal')"
                  >
                    {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                    <i class="zmdi zmdi-plus f-12 ml-1"></i>
                  </button>
                </div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <ng-select
                        *ngIf="chartLinks"
                        class="text-light"
                        [items]="chartLinks?.datasource?.metrics"
                        [multiple]="true"
                        [closeOnSelect]="true"
                        [searchable]="true"
                        [hideSelected]="true"
                        bindLabel="verbose_name"
                        bindValue="metric_name"
                        placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                        name="metrics"
                        [(ngModel)]="form_data.metrics"
                        [ngClass]="form_data.metrics == '' ? 'require-error is-invalid' : ''"
                        required
                        (add)="remappingColorpicker('', data_exploreJson)"
                        (clear)="remappingColorpicker('', data_exploreJson)"
                        (remove)="remappingColorpicker('', data_exploreJson)"
                      >
                        <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                          <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                            <span class="ng-value-label" (click)="showFormula(item, 'e')">
                              {{ item['verbose_name'] }}</span
                            >
                            <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                          </div>
                          <div class="ng-value" *ngIf="items.length > 4">
                            <span class="ng-value-label"
                              >{{ items.length - 4 }}
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                            >
                          </div>
                        </ng-template>
                      </ng-select>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label"></div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <div class="checkbox" *ngIf="chartLinks">
                        <input
                          id="order_desc"
                          name="order_desc"
                          [(ngModel)]="form_data.order_desc"
                          type="checkbox"
                          [innerHTML]="order_desc ? 'checked' : ''"
                        />
                        <label for="order_desc">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SBD' | translate }}</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row clearfix">
                <div class="col-lg-12 form-control-label">
                  <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.EL' | translate }}</label>
                </div>
                <div class="col-lg-12">
                  <div class="form-group">
                    <div class="form-line">
                      <select
                        *ngIf="chartLinks"
                        class="form-control show-tick ms select2"
                        [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                        [(ngModel)]="form_data.limit"
                        name="limit"
                      >
                        <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CL' | translate }}</option>
                        <option *ngFor="let row of list_row_limit | keyvalue" [value]="row.value[0]">
                          {{ row.value[0] }}
                        </option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Big Number  -->
          <div class="form-horizontal" *ngIf="['big_number_total'].includes(visualType)">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                >
                <button
                  *ngIf="chartLinks"
                  [ngStyle]="{ float: 'right' }"
                  type="button"
                  class="btn btn-info btn-outline btn-sm m-0 mb-3"
                  (click)="openModalTemplateCustom('formulaModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.metrics"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="verbose_name"
                      bindValue="metric_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                      name="metric"
                      [(ngModel)]="form_data.metric"
                      [ngClass]="form_data.metric == '' ? 'require-error is-invalid' : ''"
                      required
                      (add)="remappingColorpicker('', data_exploreJson)"
                      (clear)="remappingColorpicker('', data_exploreJson)"
                      (remove)="remappingColorpicker('', data_exploreJson)"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" (click)="showFormula(item, 'e')">
                            {{ item['verbose_name'] }}</span
                          >
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Histogram  -->
          <div class="form-horizontal" *ngIf="['histogram'].includes(visualType)">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                >
                <button
                  *ngIf="chartLinks"
                  [ngStyle]="{ float: 'right' }"
                  type="button"
                  class="btn btn-info btn-outline btn-sm m-0 mb-3"
                  (click)="openModalTemplateCustom('formulaModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.columns"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="column_name"
                      bindValue="column_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                      name="column_target"
                      [(ngModel)]="form_data.column_target"
                      [ngClass]="form_data.column_target == '' ? 'require-error is-invalid' : ''"
                      required
                      (add)="remappingColorpicker('', data_exploreJson)"
                      (clear)="remappingColorpicker('', data_exploreJson)"
                      (remove)="remappingColorpicker('', data_exploreJson)"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items">
                          <span class="ng-value-label" (click)="showFormula(item, 'e')">
                            {{ item['column_name'] }}</span
                          >
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Gauge  -->
          <div class="form-horizontal" *ngIf="visualType == 'gauge'">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                >
                <button
                  *ngIf="chartLinks"
                  [ngStyle]="{ float: 'right' }"
                  type="button"
                  class="btn btn-info btn-outline btn-sm m-0 mb-3"
                  (click)="openModalTemplateCustom('formulaModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.metrics"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="verbose_name"
                      bindValue="metric_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                      name="metric"
                      [(ngModel)]="form_data.metric"
                      [ngClass]="form_data.metric == '' ? 'require-error is-invalid' : ''"
                      required
                      (add)="remappingColorpicker('', data_exploreJson)"
                      (clear)="remappingColorpicker('', data_exploreJson)"
                      (remove)="remappingColorpicker('', data_exploreJson)"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" (click)="showFormula(item, 'e')">
                            {{ item['verbose_name'] }}</span
                          >
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Country Map & Overlay Map  -->
          <div class="form-horizontal" *ngIf="['map', 'country_map', 'country_map2'].includes(visualType)">
            <div class="row clearfix">
              <div class="col-lg-12 col-md-12 col-sm-6 form-control-label">
                <label
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SMT' | translate }} <font color="red"></font
                ></label>
              </div>
              <div class="col-lg-12 col-md-12 col-sm-6">
                <div class="form-group">
                  <select
                    name="viz_type"
                    [(ngModel)]="form_data.viz_type"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                    *ngIf="chartLinks"
                    [ngClass]="form_data.viz_type == '' ? 'require-error is-invalid' : ''"
                    (change)="runQuery(form_data.viz_type)"
                    required
                  >
                    <option value="country_map">Country Map</option>
                    <option value="country_map2">Overlay Map</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.ISO' | translate }}
                  <font color="red">*</font>
                </label>
              </div>
              <div class="col-sm-12" [ngClass]="entity == '' ? 'select.require-error' : ''">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.entity"
                      name="entity"
                      [ngClass]="form_data.entity == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CR' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.filterable_cols | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[0] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                >
                <button
                  *ngIf="chartLinks"
                  [ngStyle]="{ float: 'right' }"
                  type="button"
                  class="btn btn-info btn-outline btn-sm m-0 mb-3"
                  (click)="openModalTemplateCustom('formulaModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.metrics"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="verbose_name"
                      bindValue="metric_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                      name="metric"
                      [(ngModel)]="form_data.metric"
                      [ngClass]="form_data.metric == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" (click)="showFormula(item, 'e')">
                            {{ item['verbose_name'] }}</span
                          >
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div *ngIf="form_data.viz_type == 'country_map'" class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.L' | translate }} </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.map_label"
                      name="map_label"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CLL' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.filterable_cols | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[0] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div *ngIf="form_data.viz_type == 'country_map'" class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.TOOLTIP' | translate }} </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.filterable_cols | keyvals"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.ST' | translate }}"
                      name="tooltips"
                      [(ngModel)]="form_data.tooltips"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['key'] }}"> {{ item['value'] }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <!-- map overlay  -->
            <div *ngIf="form_data.viz_type == 'country_map2'" class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CRN' | translate }}
                  <font color="red">*</font>
                </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.columns"
                      name="columns"
                      [ngClass]="form_data.columns == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CC' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.filterable_cols | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[0] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div *ngIf="form_data.viz_type == 'country_map2'" class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.G' | translate }}
                  <font color="red">*</font>
                </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.groupby"
                      name="groupby"
                      [ngClass]="form_data.groupby == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SG' | translate }}</option>
                      <option *ngFor="let row of chartLinks?.datasource?.gb_cols | keyvalue" [value]="row.value[0]">
                        {{ row.value[0] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Bubble  -->
          <div class="form-horizontal" *ngIf="['bubble'].includes(visualType)">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SERIES' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.series"
                      name="series"
                      [ngClass]="form_data.series == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.filterable_cols | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.E' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.entity"
                      name="entity"
                      [ngClass]="form_data.entity == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CE' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.filterable_cols | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-lg-12 form-control-label">
                <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.RL' | translate }}</label>
              </div>
              <div class="col-lg-12">
                <div class="form-group">
                  <select
                    *ngIf="chartLinks"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                    [(ngModel)]="form_data.limit"
                    name="limit"
                  >
                    <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CL' | translate }}</option>
                    <option *ngFor="let row of list_row_limit | keyvalue" [value]="row.value[0]">
                      {{ row.value[0] }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
          </div>
          <!-- Filter Box  -->
          <div class="form-horizontal" *ngIf="visualType == 'filter_box'">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                >
                <button
                  *ngIf="chartLinks"
                  [ngStyle]="{ float: 'right' }"
                  type="button"
                  class="btn btn-info btn-outline btn-sm m-0 mb-3"
                  (click)="openModalTemplateCustom('formulaModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.metrics"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="verbose_name"
                      bindValue="metric_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                      name="metrics"
                      [(ngModel)]="form_data.metric"
                      [ngClass]="form_data.metric == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" (click)="showFormula(item, 'e')">
                            {{ item['verbose_name'] }}</span
                          >
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.FC' | translate }}</label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.filterable_cols | keyvals"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate }}"
                      name="groupby"
                      [(ngModel)]="form_data.groupby"
                      (change)="onSelectFilterCol(form_data.groupby)"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['key'] }}">{{ item['value'] }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <div class="form-group">
                  <div class="form-line">
                    <div class="checkbox">
                      <input
                        [(ngModel)]="form_data.filter_alignment_horizontal"
                        name="filter_alignment_horizontal"
                        id="filter_alignment_horizontal"
                        type="checkbox"
                      />
                      <label for="filter_alignment_horizontal">{{
                        'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.FAH' | translate
                      }}</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <div class="form-group">
                  <div class="form-line">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="date_filter"
                        name="date_filter"
                        [(ngModel)]="form_data.date_filter"
                        type="checkbox"
                        [innerHTML]="date_filter ? 'checked' : ''"
                      />
                      <label for="date_filter">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.DF' | translate }}</label>
                    </div>
                  </div>
                </div>
                <div *ngIf="form_data.date_filter">
                  <div class="form-control-label">
                    <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.DF' | translate }}</label>
                  </div>
                  <div class="form-group">
                    <div class="form-line">
                      <select
                        *ngIf="chartLinks"
                        class="form-control show-tick ms select2"
                        [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                        [(ngModel)]="form_data.filter_date"
                        name="granularity_sqla"
                      >
                        <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                        <option *ngFor="let row of filterDateList | keyvalue" [value]="row.value[0]">
                          {{ row.value[1] }}
                        </option>
                      </select>
                    </div>
                  </div>
                  <div class="form-control-label">
                    <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.DFT' | translate }}</label>
                  </div>
                  <div class="form-group">
                    <div class="form-line">
                      <select
                        *ngIf="chartLinks"
                        class="form-control show-tick ms select2"
                        [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                        [(ngModel)]="form_data.filter_date_type"
                        name="granularity_sqla"
                      >
                        <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.VALIDATOR.SDFT' | translate }}</option>
                        <option *ngFor="let row of filterDateTypeList | keyvalue" [value]="row.value[0]">
                          {{ row.value[1] }}
                        </option>
                      </select>
                    </div>
                  </div>
                  <div class="form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.TIME_COL' | translate }}</label>
                  </div>
                  <div class="form-group">
                    <div class="form-line">
                      <select
                        *ngIf="chartLinks"
                        class="form-control show-tick ms select2"
                        [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                        [(ngModel)]="form_data.granularity_sqla"
                        name="granularity_sqla"
                      >
                        <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CTC' | translate }}</option>
                        <option
                          *ngFor="let row of chartLinks?.datasource?.granularity_sqla | keyvalue"
                          [value]="row.value[0]"
                        >
                          {{ row.value[1] }}
                        </option>
                      </select>
                    </div>
                  </div>
                  <div
                    class="form-control-label"
                    *ngIf="
                      data_exploreJson?.form_data?.granularity_sqla !== undefined &&
                      data_exploreJson?.form_data?.granularity_sqla !== '' &&
                      data_exploreJson?.form_data?.granularity_sqla !== null
                    "
                  >
                    <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.IDF' | translate }}</label>
                  </div>
                  <div
                    class="form-group"
                    *ngIf="
                      data_exploreJson?.form_data?.granularity_sqla !== undefined &&
                      data_exploreJson?.form_data?.granularity_sqla !== '' &&
                      data_exploreJson?.form_data?.granularity_sqla !== null
                    "
                  >
                    <div class="form-line">
                      <select
                        *ngIf="chartLinks"
                        class="form-control show-tick ms select2"
                        [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                        [(ngModel)]="form_data.initial_date_filter"
                        name="granularity_sqla"
                      >
                        <option [value]="null">Default</option>
                        <option *ngFor="let row of initialFilterDateList | keyvalue" [value]="row.value[0]">
                          {{ row.value[1] }}
                        </option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="instant_filtering"
                        name="instant_filtering"
                        [(ngModel)]="form_data.instant_filtering"
                        type="checkbox"
                        [innerHTML]="instant_filtering ? 'checked' : ''"
                      />
                      <label for="instant_filtering">{{
                        'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.IF' | translate
                      }}</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <div class="form-group">
                  <div class="form-line">
                    <div class="checkbox">
                      <input
                        [(ngModel)]="form_data.filter_checkbox"
                        name="filter_checkbox"
                        id="filter_checkbox"
                        type="checkbox"
                      />
                      <label for="filter_checkbox">{{
                        'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SFC' | translate
                      }}</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix" *ngIf="form_data.filter_checkbox">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.FCC' | translate }}</label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="form_data.filter_checkbox_columns | keyvals"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate }}"
                      name="filter_control_checkbox"
                      [(ngModel)]="form_data.filter_control_checkbox"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label"> {{ item['key'] }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label">{{ items.length - 2 }} more...</span>
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <div class="form-group">
                  <div class="form-line">
                    <div class="checkbox">
                      <input
                        [(ngModel)]="form_data.alphabet_filter"
                        name="alphabet_filter"
                        id="alphabet_filter"
                        type="checkbox"
                      />
                      <label for="alphabet_filter">{{
                        'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SAF' | translate
                      }}</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix" *ngIf="form_data.alphabet_filter">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.FCAF' | translate }}</label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="form_data.filter_checkbox_columns | keyvals"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate }} "
                      name="filter_control_checkbox"
                      [(ngModel)]="form_data.filter_control_alphabetic"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label"> {{ item['key'] }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Directed Force  -->
          <div class="form-horizontal" *ngIf="visualType == 'directed_force'">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                >
                <button
                  *ngIf="chartLinks"
                  [ngStyle]="{ float: 'right' }"
                  type="button"
                  class="btn btn-info btn-outline btn-sm m-0 mb-3"
                  (click)="openModalTemplateCustom('formulaModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.metrics"
                      [multiple]="false"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="verbose_name"
                      bindValue="metric_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                      name="metric"
                      [(ngModel)]="form_data.metric"
                      [ngClass]="form_data.metric == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" (click)="showFormula(item, 'e')">
                            {{ item['verbose_name'] }}</span
                          >
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>

            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SOT' | translate }}
                  <font color="red">*</font>
                </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.filterable_cols | keyvals"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate }}"
                      name="groupby"
                      [(ngModel)]="form_data.groupby"
                      [ngClass]="form_data.groupby == '' ? 'require-error is-invalid' : ''"
                      required
                      (add)="remappingColorpicker('', data_exploreJson)"
                      (clear)="remappingColorpicker('', data_exploreJson)"
                      (remove)="remappingColorpicker('', data_exploreJson)"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['value'][0] }}"> {{ item['value'] }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>

            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.RL' | translate }}</label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.row_limit"
                      name="row_limit"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CL' | translate }}</option>
                      <option *ngFor="let row of list_row_limit | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.GC' | translate }}</label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SG' | translate"
                      [(ngModel)]="form_data.group"
                      name="group"
                    >
                      <option *ngFor="let row of chartLinks?.datasource?.gb_cols | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Predictive -->
          <div class="form-horizontal" *ngIf="visualType == 'predictive'">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.ML' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.pred_line"
                      name="pred_line"
                      [ngClass]="form_data.pred_line == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.UV' | translate }}
                  <font color="red">*</font>
                </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.pred_upper"
                      name="pred_upper"
                      [ngClass]="form_data.pred_upper == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.LV' | translate }}
                  <font color="red">*</font>
                </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.pred_lower"
                      name="pred_lower"
                      [ngClass]="form_data.pred_lower == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.AD' | translate }}
                  <font color="red">*</font>
                </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.pred_actual"
                      name="pred_actual"
                      [ngClass]="form_data.pred_actual == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Treemap  -->
          <div class="form-horizontal" *ngIf="['treemap', 'sunburst'].includes(visualType)">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                >
                <button
                  *ngIf="chartLinks"
                  [ngStyle]="{ float: 'right' }"
                  type="button"
                  class="btn btn-info btn-outline btn-sm m-0 mb-3"
                  (click)="openModalTemplateCustom('formulaModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.metrics"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="verbose_name"
                      bindValue="metric_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                      name="metrics"
                      [(ngModel)]="form_data.metrics"
                      [ngClass]="form_data.metrics == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" (click)="showFormula(item, 'e')">
                            {{ item['verbose_name'] }}</span
                          >
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>

            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.G' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.gb_cols | keyvals"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SG' | translate }}"
                      name="groupby"
                      [(ngModel)]="form_data.groupby"
                      [ngClass]="form_data.groupby == '' ? 'require-error is-invalid' : ''"
                      required
                      (add)="remappingColorpicker('', data_exploreJson)"
                      (clear)="remappingColorpicker('', data_exploreJson)"
                      (remove)="remappingColorpicker('', data_exploreJson)"
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['value'][0] }}">
                            <!-- id="{{ item['key'] }}" -->
                            {{ item['value'] }}
                          </span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Time Series Table  -->
          <div class="form-horizontal" *ngIf="visualType == 'time_table'">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.G' | translate }} <font color="red"></font
                ></label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.gb_cols | keyvals"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="value"
                      bindValue="value"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SG' | translate }}"
                      name="groupby"
                      [(ngModel)]="form_data.groupby"
                      [ngClass]="form_data.groupby == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" id="{{ item['key'] }}"> {{ item['value'] }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red"></font
                ></label>
                <button
                  *ngIf="chartLinks"
                  [ngStyle]="{ float: 'right' }"
                  type="button"
                  class="btn btn-info btn-outline btn-sm m-0 mb-3"
                  (click)="openModalTemplateCustom('formulaModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <ng-select
                      *ngIf="chartLinks"
                      class="text-light"
                      [items]="chartLinks?.datasource?.metrics"
                      [multiple]="true"
                      [closeOnSelect]="true"
                      [searchable]="true"
                      [hideSelected]="true"
                      bindLabel="verbose_name"
                      bindValue="metric_name"
                      placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                      name="metrics"
                      [(ngModel)]="form_data.metrics"
                      [ngClass]="form_data.groupby == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                          <span class="ng-value-label" (click)="showFormula(item, 'e')">
                            {{ item['verbose_name'] }}</span
                          >
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 4">
                          <span class="ng-value-label"
                            >{{ items.length - 2 }} {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                          >
                        </div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-lg-12 form-control-label">
                <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.RL' | translate }}</label>
              </div>
              <div class="col-lg-12">
                <div class="form-group">
                  <select
                    *ngIf="chartLinks"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                    [(ngModel)]="form_data.limit"
                    name="limit"
                  >
                    <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CL' | translate }}</option>
                    <option *ngFor="let row of list_row_limit | keyvalue" [value]="row.value[0]">
                      {{ row.value[0] }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
          </div>
          <!-- Scatter  -->
          <div class="form-horizontal" *ngIf="visualType == 'scatter'">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate"
                      [(ngModel)]="form_data.pred_actual"
                      name="pred_actual"
                      [ngClass]="form_data.pred_actual == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.ML' | translate }} <font color="red">*</font></label
                >
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.pred_line"
                      name="pred_line"
                      [ngClass]="form_data.pred_line == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.UV' | translate }}
                  <font color="red">*</font>
                </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.pred_upper"
                      name="pred_upper"
                      [ngClass]="form_data.pred_upper == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run"
                  >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.LV' | translate }}
                  <font color="red">*</font>
                </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.pred_lower"
                      name="pred_lower"
                      [ngClass]="form_data.pred_lower == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Box Plot-->
          <div class="form-horizontal" *ngIf="['box_plot'].includes(visualType)">
            <div class="form-horizontal">
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label">
                  <label for="last_run"
                    >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.V' | translate }} <font color="red">*</font></label
                  >
                  <button
                    *ngIf="chartLinks"
                    [ngStyle]="{ float: 'right' }"
                    type="button"
                    class="btn btn-info btn-outline btn-sm m-0 mb-3"
                    (click)="openModalTemplateCustom('formulaModal')"
                  >
                    {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.BF' | translate }}
                    <i class="zmdi zmdi-plus f-12 ml-1"></i>
                  </button>
                </div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <ng-select
                        *ngIf="chartLinks"
                        class="text-light"
                        [items]="chartLinks?.datasource?.metrics"
                        [multiple]="true"
                        [closeOnSelect]="true"
                        [searchable]="true"
                        [hideSelected]="true"
                        bindLabel="verbose_name"
                        bindValue="metric_name"
                        placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                        name="metrics"
                        [(ngModel)]="form_data.metrics"
                        [ngClass]="form_data.metrics == '' ? 'require-error is-invalid' : ''"
                        required
                        (add)="remappingColorpicker('', data_exploreJson)"
                        (clear)="remappingColorpicker('', data_exploreJson)"
                        (remove)="remappingColorpicker('', data_exploreJson)"
                      >
                        <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                          <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                            <span class="ng-value-label" (click)="showFormula(item, 'e')">
                              {{ item['verbose_name'] }}</span
                            >
                            <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                          </div>
                          <div class="ng-value" *ngIf="items.length > 4">
                            <span class="ng-value-label"
                              >{{ items.length - 4 }}
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                            >
                          </div>
                        </ng-template>
                      </ng-select>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.G' | translate }}</label>
                </div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <ng-select
                        *ngIf="chartLinks"
                        class="text-light"
                        [items]="chartLinks?.datasource?.gb_cols | keyvals"
                        [multiple]="true"
                        [closeOnSelect]="true"
                        [searchable]="true"
                        [hideSelected]="true"
                        bindLabel="value"
                        bindValue="value"
                        placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SG' | translate }}"
                        name="groupby"
                        [(ngModel)]="form_data.groupby"
                        (add)="remappingColorpicker('', data_exploreJson)"
                        (clear)="remappingColorpicker('', data_exploreJson)"
                        (remove)="remappingColorpicker('', data_exploreJson)"
                      >
                        <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                          <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                            <span class="ng-value-label" id="{{ item['key'] }}">{{ item['value'] }}</span>
                            <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                          </div>
                          <div class="ng-value" *ngIf="items.length > 4">
                            <span class="ng-value-label"
                              >{{ items.length - 4 }}
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                            >
                          </div>
                        </ng-template>
                      </ng-select>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SUBG' | translate }}</label>
                </div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <ng-select
                        *ngIf="chartLinks"
                        class="text-light"
                        [items]="chartLinks?.datasource?.filterable_cols | keyvals"
                        [multiple]="true"
                        [closeOnSelect]="true"
                        [searchable]="true"
                        [hideSelected]="true"
                        bindLabel="value"
                        bindValue="value"
                        placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate }}"
                        name="columns"
                        [(ngModel)]="form_data.columns"
                      >
                        <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                          <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                            <span class="ng-value-label" id="{{ item['key'] }}">{{ item['value'] }}</span>
                            <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                          </div>
                          <div class="ng-value" *ngIf="items.length > 4">
                            <span class="ng-value-label"
                              >{{ items.length - 2 }}
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.M' | translate }}</span
                            >
                          </div>
                        </ng-template>
                      </ng-select>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row clearfix">
                <div class="col-sm-12 form-control-label"></div>
                <div class="col-sm-12">
                  <div class="form-group">
                    <div class="form-line">
                      <div class="checkbox" *ngIf="chartLinks">
                        <input
                          id="order_desc"
                          name="order_desc"
                          [(ngModel)]="form_data.order_desc"
                          type="checkbox"
                          [innerHTML]="order_desc ? 'checked' : ''"
                        />
                        <label for="order_desc">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SBD' | translate }}</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row clearfix">
                <div class="col-lg-12 form-control-label">
                  <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.EL' | translate }}</label>
                </div>
                <div class="col-lg-12">
                  <div class="form-group">
                    <div class="form-line">
                      <select
                        *ngIf="chartLinks"
                        class="form-control show-tick ms select2"
                        [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                        [(ngModel)]="form_data.limit"
                        name="limit"
                      >
                        <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CL' | translate }}</option>
                        <option *ngFor="let row of list_row_limit | keyvalue" [value]="row.value[0]">
                          {{ row.value[0] }}
                        </option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Chart Options -->
    <div class="panel panel-primary m-0">
      <div class="panel-heading" role="tab" id="headingThree_1">
        <h4 class="panel-title">
          <a
            [ngClass]="{ toggled: activeColapse.chartOption == true }"
            class="menu-toggle collapsed text-uppercase"
            role="button"
            (click)="collapseOnClick('chartOption')"
            ><i
              class="zmdi zmdi-info"
              data-toggle="popover"
              data-placement="bottom"
              [attr.data-original-title]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LABEL' | translate"
              [attr.data-content]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LABEL_TOOLTIP' | translate"
            ></i
            >&nbsp;
            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LABEL' | translate }}
          </a>
        </h4>
      </div>
      <div [ngClass]="{ show: activeColapse.chartOption == true }" class="panel-collapse collapse" role="tabpanel">
        <div class="panel-body">
          <button
            *ngIf="['table'].includes(visualType)"
            type="button"
            class="btn btn-info btn-outline btn-sm w-100 m-0 mb-3"
            (click)="openModalTemplateCustom('modalColumnStyler')"
          >
            Add Custom Field Color <i class="zmdi zmdi-plus ml-1"></i>
          </button>
          <br />
          <button
            type="button"
            class="btn btn-info btn-outline btn-sm w-100 mb-2 m-0 mb-3"
            [ngClass]="slice?.slice_id > 0 && slice?.slice_id != undefined ? '' : 'disabled'"
            (click)="
              slice?.slice_id > 0 && slice?.slice_id != undefined
                ? openModalTemplateCustom('modalEditMetricLegendOptions')
                : showAlert('edit_metric')
            "
          >
            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.EVL' | translate }}
            <i class="zmdi zmdi-edit f-12 ml-1"></i>
          </button>
          <br />

          <!-- TABLE -->
          <div class="form-horizontal" *ngIf="form_data.viz_type == 'table'">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.RPP' | translate }}</label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.page_size"
                      name="row_limit"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CL' | translate }}</option>
                      <option *ngFor="let row of list_row_limit | keyvalue: originalOrder" [value]="row.value[1]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12">
                <div class="form-group">
                  <button
                    type="button"
                    class="btn btn-info btn-outline btn-sm w-100 m-0"
                    (click)="openModalTemplateCustom('modalCustomColumnFormat')"
                  >
                    {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.ACF' | translate }}
                    <i class="zmdi zmdi-plus f-12 ml-1"></i>
                  </button>
                  <button
                    type="button"
                    class="btn btn-info btn-outline btn-sm w-100 m-0 mt-2"
                    (click)="openModalTemplateCustom('modalSettingWidthColumn')"
                  >
                    {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SWC' | translate }}
                    <i class="zmdi zmdi-view-carousel f-12 ml-1"></i>
                  </button>
                </div>
              </div>
              <hr />
            </div>
          </div>

          <!-- Predictive  -->
          <div class="form-horizontal" *ngIf="['predictive'].includes(visualType)">
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <label for="last_run">Y Axis Bounds </label>
              </div>
              <div class="col-sm-12">
                <div class="form-group">
                  <div class="form-line">
                    <div class="row">
                      <div class="col-md-6">
                        <input
                          class="form-control mb-2"
                          type="text"
                          name="y_axis_bounds_min"
                          [(ngModel)]="form_data.y_axis_bounds_min"
                          placeholder="min"
                          name="y_axis_bounds_min"
                          inputNumber
                        />
                      </div>
                      <div class="col-md-6">
                        <input
                          class="form-control"
                          type="text"
                          name="y_axis_bounds_max"
                          [(ngModel)]="form_data.y_axis_bounds_max"
                          placeholder="max"
                          name="y_axis_bounds_max"
                          inputNumber
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row clearfix">
              <div class="col-sm-12">
                <div class="checkbox" *ngIf="chartLinks">
                  <input
                    id="y_log_scale"
                    name="y_log_scale"
                    [(ngModel)]="form_data.y_log_scale"
                    type="checkbox"
                    [innerHTML]="y_log_scale ? 'checked' : ''"
                  />
                  <label for="y_log_scale">Y Log Scale</label>
                </div>
              </div>
            </div>
          </div>

          <!-- Scatter  -->
          <div class="form-horizontal" *ngIf="['scatter'].includes(visualType)">
            <!-- X Axis  -->
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <div class="form-group">
                  <label for="last_run">X Axis Label </label>
                  <div class="form-line">
                    <input
                      class="form-control"
                      type="text"
                      name="x_axis_label"
                      [(ngModel)]="form_data.x_axis_label"
                      name="x_axis_label"
                    />
                  </div>
                </div>

                <div class="form-group">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LM' | translate }} </label>
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.left_margin"
                      name="left_margin"
                    >
                      <option *ngFor="let row of list_bottom_margin | keyvalue" [value]="row.value[1]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <div class="form-group">
                  <label for="last_run">X Axis </label>
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.x"
                      name="x"
                    >
                      <option
                        *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label for="last_run">X Axis Format</label>
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.x_axis_format"
                      name="x_axis_format"
                    >
                      <option *ngFor="let row of list_table_timestamp_format | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <div class="form-group">
                  <!-- <label for="last_run">X Log Scale </label> -->
                  <div class="form-line">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="x_log_scale"
                        name="x_log_scale"
                        [(ngModel)]="form_data.x_log_scale"
                        type="checkbox"
                        [innerHTML]="x_log_scale ? 'checked' : ''"
                      />
                      <label for="x_log_scale">X Log Scale</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Y Axis -->
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <div class="form-group">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.BM' | translate }} </label>
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.bottom_margin"
                      name="bottom_margin"
                    >
                      <option *ngFor="let row of list_bottom_margin | keyvalue" [value]="row.value[1]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <div class="form-group">
                  <label for="last_run">Y Axis </label>
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.y"
                      name="y"
                    >
                      <option
                        *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[0] }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label for="last_run">Y Axis Format</label>
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.y_axis_format"
                      name="y_axis_format"
                    >
                      <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <div class="form-line">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="format_number_id"
                        name="format_number_id"
                        [(ngModel)]="form_data.format_number_id"
                        type="checkbox"
                        checked=""
                        [innerHTML]="format_number_id ? 'checked' : ''"
                      />
                      <label for="format_number_id">Format ID</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row clearfix">
              <div class="col-sm-12 form-control-label">
                <div class="form-group">
                  <div class="form-line">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="y_log_scale"
                        name="y_log_scale"
                        [(ngModel)]="form_data.y_log_scale"
                        type="checkbox"
                        [innerHTML]="y_log_scale ? 'checked' : ''"
                      />
                      <label for="y_log_scale">Y Log Scale</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Markup Editor (Type, Code, CSS) -->
          <div *ngIf="['markup'].includes(visualType)">
            <div class="row clearfix">
              <div class="col-md-12">
                <button
                  type="button"
                  class="btn btn-info btn-outline btn-sm w-100 m-0"
                  (click)="openModalTemplateCustom('modalAddValue')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.AV' | translate }}
                  <i class="zmdi zmdi-plus f-12 ml-1"></i>
                </button>
              </div>
            </div>
            <div class="row clearfix mt-3">
              <div class="col-sm-12">
                <div class="form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.MT' | translate }}</label>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <select
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.markup_type"
                      name="markup_type"
                    >
                      <option value="markdown">Markdown</option>
                      <option value="html">Html</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix" *ngIf="['html', 'markdown'].includes(form_data.markup_type)">
              <div class="col-md-12">
                <div class="form-control-label">
                  <label for="last_run"
                    >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.MC' | translate }}
                    <font color="red">*</font>
                  </label>
                </div>
                <button
                  type="button"
                  class="btn btn-info btn-outline btn-sm w-100 m-0"
                  (click)="openModalTemplateCustom('codeModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.E' | translate }} {{ form_data.markup_type }}
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.C' | translate }}
                  <i class="zmdi zmdi-edit f-12 ml-1"></i>
                </button>
              </div>
            </div>
            <div class="row clearfix mt-3" *ngIf="form_data.markup_type == 'html'">
              <div class="col-sm-12">
                <div class="form-control-label">
                  <label for="last_run">CSS</label>
                </div>
                <button
                  type="button"
                  class="btn btn-info btn-outline btn-sm w-100 m-0"
                  (click)="openModalTemplateCustom('cssModal')"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.E' | translate }} CSS
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.C' | translate }}
                  <i class="zmdi zmdi-edit f-12 ml-1"></i>
                </button>
              </div>
            </div>
          </div>

          <!-- GLOBAL PROPERTIES CHART -->
          <!-- Sub Accordion -->
          <div class="collapse-group">
            <!-- Group Grid View -->
            <div class="collapse-panel" *ngIf="form_data.viz_type == 'table'">
              <label class="collapse-label" (click)="collapseOnClick('chartGridView')">{{
                'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CGV' | translate
              }}</label>
              <div [ngClass]="{ show: activeColapse.chartGridView == true }" class="collapse">
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.table_grid_view"
                            name="table_grid_view"
                            id="table_grid_view"
                            type="checkbox"
                          />
                          <label for="table_grid_view">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SGVO' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                    <div class="form-group" *ngIf="form_data.table_grid_view">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.gridview_list_view"
                            name="gridview_list_view"
                            id="gridview_list_view"
                            type="checkbox"
                          />
                          <label for="gridview_list_view">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LV' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                    <div class="form-group" *ngIf="form_data.table_grid_view">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.search_main_column"
                            name="search_main_column"
                            id="search_main_column"
                            type="checkbox"
                          />
                          <label for="search_main_column">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SMCGV' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                    <div class="form-group" *ngIf="form_data.table_grid_view">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.search_second_column"
                            name="search_second_column"
                            id="search_second_column"
                            type="checkbox"
                          />
                          <label for="search_second_column">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SSC' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Group Common Configurations -->
            <div
              class="collapse-panel"
              *ngIf="
                [
                  'heatmap',
                  'horizontal_bar',
                  'dist_bar',
                  'pie',
                  'line',
                  'box_plot',
                  'dual_line',
                  'bubble',
                  'directed_force',
                  'word_cloud',
                  'gauge',
                  'histogram',
                  'big_number_total',
                  'treemap',
                  'map',
                  'country_map',
                  'country_map2',
                  'pivot_table'
                ].includes(visualType)
              "
            >
              <input class="collapse-check" type="checkbox" id="chck99" />
              <label class="collapse-label" (click)="collapseOnClick('commonGroup')">{{
                'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CHART_COMMON' | translate
              }}</label>
              <!-- Heatmap  -->
              <div
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                class="collapse"
                *ngIf="['heatmap'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.is_axis_reverse"
                            name="is_axis_reverse"
                            id="is_axis_reverse"
                            type="checkbox"
                          />
                          <label for="is_axis_reverse">Is Axis Reverse</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-horizontal">
                  <div class="row clearfix">
                    <div class="col-lg-12 form-control-label">
                      <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SS' | translate }}</label>
                    </div>
                    <div class="col-lg-12">
                      <div class="form-group">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.style_tooltips"
                          name="row_limit"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}
                          </option>
                          <option *ngFor="let row of list_style_tooltips | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Bar  -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['horizontal_bar', 'dist_bar'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox" *ngIf="chartLinks">
                          <input
                            [(ngModel)]="form_data.show_bar_value"
                            name="show_bar_value"
                            id="show_bar_value"
                            type="checkbox"
                          />
                          <label for="show_bar_value">Bar Values </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.bar_stacked"
                            name="bar_stacked"
                            id="bar_stacked"
                            type="checkbox"
                          />
                          <label for="bar_stacked">Stacked Bar</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix" *ngIf="form_data.bar_stacked">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line checkbox">
                        <input
                          type="checkbox"
                          id="count_stacked"
                          name="count_stacked"
                          [(ngModel)]="form_data.count_stacked"
                        /><label for="count_stacked">Count Stacked</label>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.is_first_axis_label"
                            name="is_first_axis_label"
                            id="is_first_axis_label"
                            type="checkbox"
                          />
                          <label for="is_first_axis_label">Show First Axis Group</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.is_axis_reverse"
                            name="is_axis_reverse"
                            id="is_axis_reverse"
                            type="checkbox"
                          />
                          <label for="is_axis_reverse">Is Axis Reverse</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">Rotate X Axis</label>
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.rotate_axis"
                          name="rotate_axis"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}
                          </option>
                          <option *ngFor="let row of list_rotate_axis | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                            <span>&#176;</span>
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox" *ngIf="chartLinks">
                          <input
                            id="show_only_one_value"
                            name="show_only_one_value"
                            [(ngModel)]="form_data.show_only_one_value"
                            type="checkbox"
                            checked=""
                            [innerHTML]="show_only_one_value ? 'checked' : ''"
                          />
                          <label for="show_only_one_value">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SOV' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.YARB' | translate }} </label>
                      <div class="form-line">
                        <div class="row">
                          <div class="col-md-6">
                            <input
                              InputNumber
                              class="form-control"
                              type="text"
                              name="y_axis_bounds_min"
                              [(ngModel)]="form_data.y_axis_bounds_min"
                              placeholder="min"
                              name="y_axis_bounds_min"
                            />
                          </div>
                          <div class="col-md-6">
                            <input
                              InputNumber
                              class="form-control"
                              type="text"
                              name="y_axis_bounds_max"
                              [(ngModel)]="form_data.y_axis_bounds_max"
                              placeholder="max"
                              name="y_axis_bounds_max"
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-horizontal">
                  <div class="row clearfix">
                    <div class="col-lg-12 form-control-label">
                      <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.ST' | translate }}</label>
                    </div>
                    <div class="col-lg-12">
                      <div class="form-group">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.style_tooltips"
                          name="row_limit"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}
                          </option>
                          <option *ngFor="let row of list_style_tooltips | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Pie -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['pie'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="checkbox">
                      <input [(ngModel)]="form_data.donut" name="donut" id="donut" type="checkbox" />
                      <label for="donut">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.D' | translate }}</label>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Line & Boxplot -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['line', 'box_plot'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox" *ngIf="chartLinks">
                          <input
                            id="show_brush"
                            name="show_brush"
                            [(ngModel)]="form_data.show_brush"
                            type="checkbox"
                            [innerHTML]="show_brush ? 'checked' : ''"
                          />
                          <label for="show_brush">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.RF' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group" *ngIf="['line'].includes(visualType)">
                  <div class="form-line">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="show_markers"
                        name="show_markers"
                        [(ngModel)]="form_data.show_markers"
                        type="checkbox"
                        [innerHTML]="show_markers ? 'checked' : ''"
                      />
                      <label for="show_markers">{{
                        'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SM' | translate
                      }}</label>
                    </div>
                  </div>
                </div>
                <div class="row clearfix" *ngIf="['line'].includes(visualType)">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run"> {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SM' | translate }} </label>
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.line_interpolation"
                          name="line_interpolation"
                        >
                          <option *ngFor="let row of list_line_interpolation | keyvalue" [value]="row.value[1]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">Y Axis Bounds </label>
                      <div class="form-line">
                        <div class="row">
                          <div class="col-md-6">
                            <input
                              class="form-control"
                              type="text"
                              name="y_axis_bounds_min"
                              [(ngModel)]="form_data.y_axis_bounds_min"
                              placeholder="min"
                              name="y_axis_bounds_min"
                              inputNumber
                            />
                          </div>
                          <div class="col-md-6">
                            <input
                              class="form-control"
                              type="text"
                              name="y_axis_bounds_max"
                              [(ngModel)]="form_data.y_axis_bounds_max"
                              placeholder="max"
                              name="y_axis_bounds_max"
                              inputNumber
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix" *ngIf="['line'].includes(visualType)">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox" *ngIf="chartLinks">
                          <input
                            id="y_log_scale"
                            name="y_log_scale"
                            [(ngModel)]="form_data.y_log_scale"
                            type="checkbox"
                            [innerHTML]="y_log_scale ? 'checked' : ''"
                          />
                          <label for="y_log_scale">Y Log Scale</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix" *ngIf="['line'].includes(visualType)">
                  <div class="col-sm-12 form-control-label"></div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="form-line">
                          <div class="checkbox" *ngIf="chartLinks">
                            <input
                              id="area_chart"
                              name="area_chart"
                              [(ngModel)]="form_data.area_chart"
                              type="checkbox"
                              [innerHTML]="area_chart ? 'checked' : ''"
                            />
                            <label for="area_chart">Area Chart</label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix" *ngIf="form_data?.area_chart">
                  <div class="col-sm-12 form-control-label"></div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="form-line">
                          <div class="checkbox" *ngIf="chartLinks">
                            <input
                              id="stack_area_chart"
                              name="stack_area_chart"
                              [(ngModel)]="form_data.stack_area_chart"
                              type="checkbox"
                              [innerHTML]="stack_area_chart ? 'checked' : ''"
                            />
                            <label for="stack_area_chart">Stack Area Chart</label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-horizontal" *ngIf="['line'].includes(visualType)">
                  <div class="row clearfix">
                    <div class="col-lg-12 form-control-label">
                      <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.ST' | translate }}</label>
                    </div>
                    <div class="col-lg-12">
                      <div class="form-group">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.style_tooltips"
                          name="row_limit"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}
                          </option>
                          <option *ngFor="let row of list_style_tooltips | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Dual Line -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['dual_line'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run"
                        >Y Axis 1 Value
                        <font color="red">*</font>
                      </label>
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.metric"
                          name="metric"
                          [ngClass]="form_data.metric == '' ? 'require-error is-invalid' : ''"
                          required
                        >
                          <option *ngFor="let row of chartLinks?.datasource?.metrics" [value]="row.metric_name">
                            {{ row.verbose_name }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run"
                        >Y Axis 2 Value
                        <font color="red">*</font>
                      </label>
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.metric_2"
                          name="metric_2"
                          [ngClass]="form_data.metric_2 == '' ? 'require-error is-invalid' : ''"
                          required
                        >
                          <option *ngFor="let row of chartLinks?.datasource?.metrics" [value]="row.metric_name">
                            {{ row.verbose_name }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Bubble -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['bubble'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run"
                      >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.BS' | translate }}
                      <font color="red">*</font>
                    </label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.size"
                          name="size"
                          [ngClass]="form_data.size == '' ? 'require-error is-invalid' : ''"
                          required
                        >
                          <option
                            *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                            [value]="row.value[0]"
                          >
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.MBS' | translate }} </label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.max_bubble_size"
                          name="max_bubble_size"
                        >
                          <option *ngFor="let row of list_page_length2 | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run"
                        >X Axis
                        <font color="red">*</font>
                      </label>
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.x"
                          name="x"
                          [ngClass]="form_data.x == '' ? 'require-error is-invalid' : ''"
                          required
                        >
                          <option
                            *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                            [value]="row.value[0]"
                          >
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox" *ngIf="chartLinks">
                          <input
                            id="x_log_scale"
                            name="x_log_scale"
                            [(ngModel)]="form_data.x_log_scale"
                            type="checkbox"
                            [innerHTML]="x_log_scale ? 'checked' : ''"
                          />
                          <label for="x_log_scale">X Log Scale</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run"
                        >Y Axis
                        <font color="red">*</font>
                      </label>
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.y"
                          name="y"
                          [ngClass]="form_data.y == '' ? 'require-error is-invalid' : ''"
                          required
                        >
                          <option
                            *ngFor="let row of chartLinks?.datasource?.metrics_combo | keyvalue"
                            [value]="row.value[0]"
                          >
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <!-- <label for="last_run">Y Log Scale </label> -->
                      <div class="form-line">
                        <div class="checkbox" *ngIf="chartLinks">
                          <input
                            id="y_log_scale"
                            name="y_log_scale"
                            [(ngModel)]="form_data.y_log_scale"
                            type="checkbox"
                            [innerHTML]="y_log_scale ? 'checked' : ''"
                          />
                          <label for="y_log_scale">Y Log Scale </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Directed Force -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['directed_force'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LL' | translate }} </label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.link_length"
                          name="link_length"
                        >
                          <option *ngFor="let row of list_link_length | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">Charge </label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.charge"
                          name="charge"
                        >
                          <option *ngFor="let row of list_charge | keyvalue" [value]="row.value[1]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Wordcloud -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['word_cloud'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">Rotation</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.rotation"
                          name="rotation"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Rotation
                          </option>
                          <option *ngFor="let row of list_rotation | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">Spiral</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.spiral"
                          name="spiral"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Spiral
                          </option>
                          <option *ngFor="let row of list_spiral | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SCALE' | translate }}</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.scale"
                          name="scale"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Scale
                          </option>
                          <option *ngFor="let row of list_scale | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.FS' | translate }}</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <input
                          class="form-control"
                          type="text"
                          name="font_size"
                          placeholder="font size"
                          [(ngModel)]="form_data.font_size"
                          inputNumber
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.FT' | translate }}</label>
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.font_family"
                          name="font_family"
                        >
                          <option [value]="null">Default</option>
                          <option *ngFor="let row of fontFamilyList | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- <div class="row clearfix">
                            <div class="col-sm-12 form-control-label">
                                <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.DISTANCE' | translate }}</label>
                            </div>
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <div class="form-line">
                                        <input class="form-control" type="text" name="distance" placeholder="distance" [(ngModel)]="form_data.distance" inputNumber />
                                    </div>
                                </div>
                            </div>
                        </div> -->
              </div>
              <!-- Gauge -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['gauge'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.custom_condition"
                            name="custom_condition"
                            id="custom_condition"
                            type="checkbox"
                          />
                          <label for="custom_condition"
                            >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CUSTOM_COND' | translate }}
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix" *ngIf="form_data?.custom_condition">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <button
                        type="button"
                        class="btn btn-info btn-outline btn-sm w-100 m-0"
                        (click)="openModalTemplateCustom('modalCustomCondition')"
                      >
                        {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.ACCOND' | translate }}
                        <i class="zmdi zmdi-plus f-12 ml-1"></i>
                      </button>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run"
                      >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.MVG' | translate }} <font color="red"></font
                    ></label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <input
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.max_value"
                          name="max_value"
                          [ngClass]="form_data.max_value == '' ? 'require-error is-invalid' : ''"
                          required
                          inputNumber
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.show_needle"
                            name="show_needle"
                            id="show_needle"
                            type="checkbox"
                          />
                          <label for="show_needle"
                            >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SN' | translate }}
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Histogram -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['histogram'].includes(form_data.viz_type) || ['histogram'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">Range</label>
                      <div class="form-line">
                        <input
                          class="form-control"
                          type="text"
                          name="range"
                          [(ngModel)]="form_data.range"
                          name="range"
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">Domain</label>
                      <div class="form-line">
                        <input
                          class="form-control"
                          type="text"
                          name="domain"
                          [(ngModel)]="form_data.domain"
                          name="domain"
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="form-line">
                    <div class="col-md-12">
                      <div class="checkbox">
                        <input
                          id="checkbox2"
                          type="checkbox"
                          checked=""
                          [(ngModel)]="form_data.chart_tooltip"
                          [innerHTML]="chart_on_click ? 'checked' : ''"
                        />
                        <label for="checkbox2">
                          {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.AT' | translate }}
                        </label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Big Number -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['big_number_total'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.VFS' | translate }}</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <input
                          class="form-control"
                          type="text"
                          name="zoomsize"
                          placeholder="zoomsize"
                          [(ngModel)]="form_data.zoomsize"
                          inputNumber
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="show_border"
                        name="show_border"
                        [(ngModel)]="form_data.show_border"
                        type="checkbox"
                        checked=""
                        [innerHTML]="show_border ? 'checked' : ''"
                      />
                      <label for="show_border">{{
                        'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SBORDER' | translate
                      }}</label>
                    </div>
                  </div>
                </div>
                <div class="row clearfix" *ngIf="form_data?.show_border">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run" class="mb-0"
                      >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.BP' | translate }}
                    </label>
                  </div>
                  <div class="col-sm-12 mb-2">
                    <button
                      [ngClass]="
                        form_data.border_position == 'left'
                          ? 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini active ml-0'
                          : 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini btn-sm ml-0'
                      "
                      (click)="setBorderPosition('left')"
                      data-toggle="tooltip"
                      data-placement="bottom"
                      title=""
                      data-original-title="Label Align Left"
                    >
                      <img src="./assets/images/v_left.svg" width="10" height="10" alt="Label Align Left" />
                    </button>

                    <button
                      [ngClass]="
                        form_data.border_position == 'right'
                          ? 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini active'
                          : 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini'
                      "
                      (click)="setBorderPosition('right')"
                      data-toggle="tooltip"
                      data-placement="bottom"
                      title=""
                      data-original-title="Label Align Right"
                    >
                      <img src="./assets/images/v_right.svg" width="10" height="10" alt="Label Align Right" />
                    </button>

                    <button
                      [ngClass]="
                        form_data.border_position == 'top'
                          ? 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini active'
                          : 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini'
                      "
                      (click)="setBorderPosition('top')"
                      data-toggle="tooltip"
                      data-placement="bottom"
                      title=""
                      data-original-title="Label Align Top"
                    >
                      <img src="./assets/images/v_top.svg" width="10" height="10" alt="Label Align Top" />
                    </button>

                    <button
                      [ngClass]="
                        form_data.border_position == 'bottom'
                          ? 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini active'
                          : 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini'
                      "
                      (click)="setBorderPosition('bottom')"
                      data-toggle="tooltip"
                      data-placement="bottom"
                      title=""
                      data-original-title="Label Align Bottom"
                    >
                      <img src="./assets/images/v_bottom.svg" width="10" height="10" alt="Label Align Bottom" />
                    </button>
                  </div>
                </div>
              </div>
              <!-- Markup -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['markup'].includes(visualType)"
              ></div>
              <!-- Treemap -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['treemap'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">Ratio </label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <input
                          class="form-control"
                          type="text"
                          class="form-control"
                          placeholder="number treemap ratio"
                          [(ngModel)]="form_data.treemap_ratio"
                          name="treemap_ratio"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Map -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['map', 'country_map', 'country_map2'].includes(visualType)"
              >
                <div *ngIf="form_data.viz_type == 'country_map'">
                  <div class="row clearfix">
                    <div class="col-md-12">
                      <div class="form-control-label">
                        <label for="last_run"
                          >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CN' | translate }}
                          <font color="red">*</font>
                        </label>
                      </div>
                      <div class="form-group">
                        <div class="form-line">
                          <select
                            *ngIf="chartLinks"
                            class="form-control show-tick ms select2"
                            [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                            [(ngModel)]="form_data.select_country2"
                            name="select_country"
                            [ngClass]="form_data.select_country == '' ? 'require-error is-invalid' : ''"
                            required
                          >
                            <option [value]="null">
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Country
                            </option>
                            <option *ngFor="let row of list_select_country | keyvalue" [value]="row.value[0]">
                              {{ row.value[1] }}
                            </option>
                          </select>
                        </div>
                      </div>
                    </div>

                    <div *ngIf="form_data.select_country == 'indonesia'">
                      <div
                        class="col-sm-12 form-control-label"
                        [ngClass]="form_data.select_province == '' ? 'label.error' : ''"
                      >
                        <label for="select_province">{{
                          'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SPN' | translate
                        }}</label>
                      </div>
                      <div class="col-sm-12" [ngClass]="form_data.select_province == '' ? 'select.require-error' : ''">
                        <div class="form-group">
                          <div class="form-line">
                            <select
                              *ngIf="chartLinks"
                              class="form-control show-tick ms select2"
                              [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                              [(ngModel)]="form_data.select_province"
                              name="select_province"
                            >
                              <option [value]="null">
                                {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CP' | translate }}
                              </option>
                              <option *ngFor="let row of list_select_province | keyvalue" [value]="row.value[0]">
                                {{ row.value[1] }}
                              </option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row clearfix">
                    <div class="col-sm-12">
                      <div class="checkbox">
                        <input
                          [(ngModel)]="form_data.is_point_tooltip"
                          name="is_point_tooltip"
                          id="is_point_tooltip"
                          type="checkbox"
                        />
                        <label for="is_point_tooltip">{{
                          'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.IPT' | translate
                        }}</label>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- map overlay  -->
                <div *ngIf="form_data.viz_type == 'country_map2'">
                  <div class="row clearfix">
                    <div class="col-md-12">
                      <div class="form-control-label">
                        <label for="last_run"
                          >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS' | translate }}Country Name
                          <font color="red">*</font>
                        </label>
                      </div>
                      <div class="form-group">
                        <div class="form-line">
                          <select
                            *ngIf="chartLinks"
                            class="form-control show-tick ms select2"
                            [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                            [(ngModel)]="form_data.select_country2"
                            name="select_country2"
                            [ngClass]="form_data.select_country2 == '' ? 'require-error is-invalid' : ''"
                            required
                          >
                            <option [value]="null">
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Country
                            </option>
                            <option *ngFor="let row of list_select_country_overlay | keyvalue" [value]="row.value[0]">
                              {{ row.value[1] }}
                            </option>
                          </select>
                        </div>
                      </div>
                    </div>

                    <div *ngIf="form_data.select_country == 'indonesia'">
                      <div
                        class="col-sm-12 form-control-label"
                        [ngClass]="form_data.select_province == '' ? 'label.error' : ''"
                      >
                        <label for="select_province">{{
                          'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.PN' | translate
                        }}</label>
                      </div>
                      <div class="col-sm-12" [ngClass]="form_data.select_province == '' ? 'select.require-error' : ''">
                        <div class="form-group">
                          <div class="form-line">
                            <select
                              *ngIf="chartLinks"
                              class="form-control show-tick ms select2"
                              [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                              [(ngModel)]="form_data.select_province"
                              name="select_province"
                            >
                              <option [value]="null">
                                {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Province
                              </option>
                              <option *ngFor="let row of list_select_province | keyvalue" [value]="row.value[0]">
                                {{ row.value[1] }}
                              </option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- <div class="row clearfix">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <div class="form-line">
                                            <div class="checkbox">
                                                <input
                                                    [(ngModel)]="
                                                        form_data.hide_overlay
                                                    "
                                                    name="hide_overlay"
                                                    id="hide_overlay"
                                                    type="checkbox"
                                                />
                                                <label for="hide_overlay"
                                                    >Hide Overlay
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div> -->
                </div>
                <div class="row clearfix mt-2">
                  <div class="col-sm-12">
                    <div class="checkbox">
                      <input [(ngModel)]="form_data.hide_value" name="hide_value" id="hide_value" type="checkbox" />
                      <label for="hide_value">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.HV' | translate }}</label>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Pivot Table -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.commonGroup == true }"
                *ngIf="['pivot_table'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.pivot_margins"
                            name="pivot_margins"
                            id="pivot_margins"
                            type="checkbox"
                          />
                          <label for="pivot_margins"
                            >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SHOW_TOT' | translate }}
                          </label>
                        </div>
                      </div>
                      <div class="form-line">
                        <div class="checkbox" *ngIf="chartLinks">
                          <input
                            [(ngModel)]="form_data.combine_metric"
                            name="combine_metric"
                            id="combine_metric"
                            type="checkbox"
                          />
                          <label for="combine_metric"
                            >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CM' | translate }}
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">Aggregation Function </label>
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.pandas_aggfunc"
                          name="pandas_aggfunc"
                        >
                          <option *ngFor="let row of list_pandas_aggfunc | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Group Chart Format-->
            <div
              class="collapse-panel"
              *ngIf="
                [
                  'dist_bar',
                  'horizontal_bar',
                  'line',
                  'dual_line',
                  'pie',
                  'treemap',
                  'sunburst',
                  'directed_force',
                  'bubble',
                  'country_map',
                  'country_map2',
                  'map',
                  'word_cloud',
                  'gauge',
                  'big_number_total',
                  'predictive',
                  'pivot_table',
                  'box_plot',
                  'heatmap',
                  'scatter'
                ].includes(visualType)
              "
            >
              <input class="collapse-check" type="checkbox" id="chck2" />
              <label class="collapse-label" (click)="collapseOnClick('chartFormatGroup')">{{
                'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CF' | translate
              }}</label>
              <div class="collapse" [ngClass]="{ show: activeColapse.chartFormatGroup == true }">
                <!-- Format ID -->
                <div
                  class="form-group"
                  *ngIf="
                    [
                      'dist_bar',
                      'horizontal_bar',
                      'line',
                      'dual_line',
                      'pie',
                      'treemap',
                      'sunburst',
                      'directed_force',
                      'bubble',
                      'country_map',
                      'country_map2',
                      'map',
                      'word_cloud',
                      'gauge',
                      'big_number_total',
                      'predictive',
                      'pivot_table',
                      'box_plot'
                    ].includes(form_data.viz_type) ||
                    [
                      'dist_bar',
                      'horizontal_bar',
                      'line',
                      'dual_line',
                      'pie',
                      'treemap',
                      'sunburst',
                      'directed_force',
                      'bubble',
                      'country_map',
                      'country_map2',
                      'map',
                      'word_cloud',
                      'gauge',
                      'big_number_total',
                      'predictive',
                      'pivot_table',
                      'box_plot'
                    ].includes(visualType)
                  "
                >
                  <div class="form-line">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="format_number_id"
                        name="format_number_id"
                        [(ngModel)]="form_data.format_number_id"
                        type="checkbox"
                        checked=""
                        [innerHTML]="format_number_id ? 'checked' : ''"
                      />
                      <label for="format_number_id">Format ID</label>
                    </div>
                  </div>
                </div>
                <div
                  class="row clearfix"
                  *ngIf="['directed_force'].includes(form_data.viz_type) || ['directed_force'].includes(visualType)"
                >
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.NF' | translate }}</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.number_format"
                          name="number_format"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.NF' | translate }}
                          </option>
                          <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  class="row clearfix"
                  *ngIf="['heatmap'].includes(form_data.viz_type) || ['heatmap'].includes(visualType)"
                >
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.NF' | translate }}</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.number_format"
                          name="number_format"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.NF' | translate }}
                          </option>
                          <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Y Axis Format -->
                <div
                  class="form-group"
                  *ngIf="
                    ['dist_bar', 'horizontal_bar', 'line', 'box_plot'].includes(form_data.viz_type) ||
                    ['dist_bar', 'horizontal_bar', 'line', 'box_plot'].includes(visualType)
                  "
                >
                  <label for="last_run">Y Axis Format</label>
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.y_axis_format"
                      name="y_axis_format"
                    >
                      <option [value]="null">
                        {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Y Axis Format
                      </option>
                      <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
                <!-- Tooltips Format Number  -->
                <div
                  class="form-group"
                  *ngIf="
                    ['dist_bar', 'horizontal_bar', 'line', 'dual_line', 'box_plot'].includes(form_data.viz_type) ||
                    ['dist_bar', 'horizontal_bar', 'line', 'dual_line', 'box_plot'].includes(visualType)
                  "
                >
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CF' | translate }}</label>
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.format_number_tooltips"
                      name="format_number_tooltips"
                    >
                      <option [value]="null">
                        {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CTFN' | translate }}
                      </option>
                      <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
                <!-- Y Dual Axis Format -->
                <div
                  class="form-group"
                  *ngIf="
                    ['dist_bar', 'horizontal_bar'].includes(form_data.viz_type) ||
                    ['dist_bar', 'horizontal_bar'].includes(visualType)
                  "
                >
                  <label for="last_run">Y Dual Axis Format</label>
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.y_axis_2_format"
                      name="y_axis_2_format"
                    >
                      <option [value]="null">
                        {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Y Dual Axis Format
                      </option>
                      <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
                <!-- Pie -->
                <div class="row clearfix" *ngIf="['pie'].includes(form_data.viz_type) || ['pie'].includes(visualType)">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.NF' | translate }}</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.y_axis_format"
                          name="y_axis_format"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Number Format
                          </option>
                          <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Line -->
                <div
                  class="row clearfix"
                  *ngIf="['line'].includes(form_data.viz_type) || ['line'].includes(visualType)"
                >
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">X Axis Format</label>
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.x_axis_format"
                          name="x_axis_format"
                        >
                          <option *ngFor="let row of list_table_timestamp_format | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Dual Line -->
                <div
                  class="row clearfix"
                  *ngIf="['dual_line'].includes(form_data.viz_type) || ['dual_line'].includes(visualType)"
                >
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">Y Axis 1 Format </label>
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.y_axis_format"
                          name="y_axis_format"
                        >
                          <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="last_run">Y Axis 2 Format</label>
                    <div class="form-line">
                      <select
                        *ngIf="chartLinks"
                        class="form-control show-tick ms select2"
                        [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                        [(ngModel)]="form_data.y_axis_2_format"
                        name="y_axis_2_format"
                      >
                        <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                          {{ row.value[1] }}
                        </option>
                      </select>
                    </div>
                  </div>
                </div>
                <!-- Gauge -->
                <div
                  class="row clearfix"
                  *ngIf="['gauge'].includes(form_data.viz_type) || ['gauge'].includes(visualType)"
                >
                  <div class="col-md-12 form-group">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.NF' | translate }}</label>
                    <div class="form-line">
                      <select
                        *ngIf="chartLinks"
                        class="form-control show-tick ms select2"
                        [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                        [(ngModel)]="form_data.number_format"
                        name="number_format"
                      >
                        <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                          {{ row.value[1] }}
                        </option>
                      </select>
                    </div>
                  </div>
                </div>
                <!-- Big Number -->
                <div
                  class="row clearfix"
                  *ngIf="['big_number_total'].includes(form_data.viz_type) || ['big_number_total'].includes(visualType)"
                >
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.NF' | translate }}</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.y_axis_format"
                          name="y_axis_format"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Number Format
                          </option>
                          <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Treemap -->
                <div
                  class="row clearfix"
                  *ngIf="['treemap'].includes(form_data.viz_type) || ['treemap'].includes(visualType)"
                >
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.NF' | translate }} </label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.number_format"
                          name="number_format"
                        >
                          <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Map -->
                <div class="row clearfix" *ngIf="['map', 'country_map', 'country_map2'].includes(visualType)">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.NF' | translate }}</label>
                  </div>
                  <div class="col-md-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.number_format"
                          name="number_format"
                        >
                          <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Pivot Table -->
                <div
                  class="row clearfix"
                  *ngIf="['pivot_table'].includes(form_data.viz_type) || ['pivot_table'].includes(visualType)"
                >
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.NF' | translate }} </label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.number_format"
                          name="number_format"
                        >
                          <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Predictive -->
                <div class="row clearfix" *ngIf="['predictive', 'scatter'].includes(visualType)">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">X Axis Format</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.x_axis_format"
                          name="x_axis_format"
                        >
                          <option *ngFor="let row of list_table_timestamp_format | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-12">
                    <label for="last_run">Y Axis Format</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.y_axis_format"
                          name="y_axis_format"
                        >
                          <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Sunburst  -->
                <div
                  class="row clearfix"
                  *ngIf="['sunburst'].includes(form_data.viz_type) || ['sunburst'].includes(visualType)"
                >
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.NF' | translate }} </label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.number_format"
                          name="number_format"
                        >
                          <option *ngFor="let row of list_y_axis_format | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Group Chart Color-->
            <div
              class="collapse-panel"
              *ngIf="
                [
                  'dist_bar',
                  'horizontal_bar',
                  'line',
                  'dual_line',
                  'pie',
                  'treemap',
                  'directed_force',
                  'bubble',
                  'country_map',
                  'country_map2',
                  'map',
                  'box_plot',
                  'big_number_total',
                  'histogram',
                  'sunburst',
                  'word_cloud'
                ].includes(visualType)
              "
            >
              <input class="collapse-check" type="checkbox" id="chck1" />
              <label class="collapse-label" (click)="collapseOnClick('chartColorGroup')">{{
                'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CC' | translate
              }}</label>
              <div class="collapse" [ngClass]="{ show: activeColapse.chartColorGroup == true }">
                <div
                  class="row clearfix"
                  *ngIf="
                    [
                      'dist_bar',
                      'horizontal_bar',
                      'line',
                      'dual_line',
                      'pie',
                      'treemap',
                      'directed_force',
                      'bubble',
                      'country_map',
                      'box_plot'
                    ].includes(form_data.viz_type) ||
                    [
                      'dist_bar',
                      'horizontal_bar',
                      'line',
                      'dual_line',
                      'pie',
                      'treemap',
                      'directed_force',
                      'bubble',
                      'country_map',
                      'box_plot'
                    ].includes(visualType)
                  "
                >
                  <div class="pl-2">
                    <mat-radio-group
                      aria-labelledby="radio-group-label"
                      class="radio-group-choose-colorpicker radio-group mt-0 mb-0"
                      name="choose_pallete"
                      [(ngModel)]="form_data.choose_pallete"
                      required
                    >
                      <mat-radio-button class="radio-button" value="default_pallete">
                        {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.DP' | translate }}
                      </mat-radio-button>
                      <mat-radio-button
                        *ngIf="form_data.viz_type != 'directed_force'"
                        class="radio-button"
                        value="custom_pallete"
                      >
                        {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CUST_COLOR' | translate }}
                      </mat-radio-button>
                      <mat-radio-button
                        *ngIf="form_data.viz_type == 'directed_force' && form_data?.group != undefined"
                        class="radio-button"
                        value="custom_pallete"
                      >
                        {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CUST_COLOR' | translate }}
                      </mat-radio-button>
                    </mat-radio-group>
                  </div>
                </div>
                <!-- set color picker every entity  -->
                <div
                  *ngIf="
                    form_data?.choose_pallete == 'custom_pallete' &&
                    ([
                      'dist_bar',
                      'horizontal_bar',
                      'line',
                      'dual_line',
                      'pie',
                      'treemap',
                      'directed_force',
                      'bubble',
                      'country_map',
                      'box_plot'
                    ].includes(form_data.viz_type) ||
                      [
                        'dist_bar',
                        'horizontal_bar',
                        'line',
                        'dual_line',
                        'pie',
                        'treemap',
                        'directed_force',
                        'bubble',
                        'country_map',
                        'box_plot'
                      ].includes(visualType))
                  "
                >
                  <div class="row clearfix mb-3">
                    <div class="col-md-12">
                      <button
                        type="button"
                        class="btn btn-info btn-outline btn-sm w-100 m-0"
                        [ngClass]="slice?.slice_id == undefined ? 'disabled' : ''"
                        (click)="
                          slice?.slice_id > 0 && slice?.slice_id != undefined
                            ? openModalTemplateCustom('modalColorPicker')
                            : showAlert('custom_color')
                        "
                      >
                        {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.ACC' | translate }}
                        <i class="zmdi zmdi-format-color-fill f-12 ml-1"></i>
                      </button>
                    </div>
                  </div>
                </div>
                <div
                  class="row clearfix mb-3"
                  *ngIf="
                    ['big_number_total', 'histogram'].includes(form_data.viz_type) &&
                    ['big_number_total', 'histogram'].includes(visualType)
                  "
                >
                  <div class="col-md-12">
                    <button
                      type="button"
                      class="btn btn-info btn-outline btn-sm w-100 m-0"
                      [ngClass]="slice?.slice_id == undefined ? 'disabled' : ''"
                      (click)="
                        slice?.slice_id > 0 && slice?.slice_id != undefined
                          ? openModalTemplateCustom('modalColorPicker')
                          : showAlert('custom_color')
                      "
                    >
                      {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.ACC' | translate }}
                      <i class="zmdi zmdi-format-color-fill f-12 ml-1"></i>
                    </button>
                  </div>
                </div>

                <div
                  class="form-horizontal"
                  *ngIf="
                    [
                      'dist_bar',
                      'horizontal_bar',
                      'line',
                      'dual_line',
                      'pie',
                      'treemap',
                      'sunburst',
                      'directed_force',
                      'bubble',
                      'country_map',
                      'country_map2',
                      'map',
                      'word_cloud',
                      'box_plot'
                    ].includes(form_data.viz_type) ||
                    [
                      'dist_bar',
                      'horizontal_bar',
                      'line',
                      'dual_line',
                      'pie',
                      'treemap',
                      'sunburst',
                      'directed_force',
                      'bubble',
                      'country_map',
                      'country_map2',
                      'map',
                      'word_cloud',
                      'box_plot'
                    ].includes(visualType)
                  "
                >
                  <div class="row clearfix" *ngIf="form_data?.choose_pallete == 'default_pallete'">
                    <!-- <div class="col-sm-12 form-control-label">
                                    <label for="last_run">Color Palette </label>
                                </div> -->
                    <div class="col-md-12 form-group">
                      <div class="btn-group w-100">
                        <button
                          type="button"
                          class="btn btn-primary btn-block dropdown-toggle btn-color-palette"
                          data-toggle="dropdown"
                          style="width: 100%"
                        >
                          <span
                            *ngFor="let item of colorSchema[index]"
                            style="display: inline-block; width: 9px; height: 9px; margin-right: 3px"
                            [ngStyle]="{
                              'background-color': item
                            }"
                            >&nbsp;</span
                          >
                        </button>
                        <div class="dropdown-menu">
                          <a
                            *ngFor="let pal of colorSchema; index as j"
                            class="dropdown-item"
                            href="javascript:;"
                            (click)="chooseColor('palette' + (j + 1), j)"
                          >
                            <span
                              *ngFor="let item of pal"
                              style="display: inline-block; width: 9px; height: 9px; margin-right: 3px"
                              [ngStyle]="{
                                'background-color': item
                              }"
                              >&nbsp;</span
                            >
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row clearfix mt-2" *ngIf="form_data?.choose_pallete == 'default_pallete'">
                    <div class="col-sm-12">
                      <div class="form-group">
                        <div class="form-line">
                          <div class="checkbox">
                            <input
                              [(ngModel)]="form_data.random_color"
                              name="random_color"
                              id="random_color"
                              type="checkbox"
                            />
                            <label for="random_color">{{
                              'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.RC' | translate
                            }}</label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Group Chart Sort-->
            <div class="collapse-panel" *ngIf="['horizontal_bar', 'dist_bar'].includes(visualType)">
              <input class="collapse-check" type="checkbox" id="chck3" />
              <label class="collapse-label" (click)="collapseOnClick('chartSortGroup')">{{
                'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CS' | translate
              }}</label>
              <!-- Bar -->
              <div
                *ngIf="['horizontal_bar', 'dist_bar'].includes(visualType)"
                class="collapse"
                [ngClass]="{ show: activeColapse.chartSortGroup == true }"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">{{
                        'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SORT_BY' | translate
                      }}</label>
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.dist_bar_sorter"
                          name="dist_bar_sorter"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Sort By
                          </option>
                          <option *ngFor="let row of list_dist_bar_sorter | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox" *ngIf="chartLinks">
                          <input [(ngModel)]="form_data.order_desc" name="order_desc" id="order_desc" type="checkbox" />
                          <label for="order_desc"
                            >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SBD' | translate }}
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox" *ngIf="chartLinks">
                          <input
                            id="show_label_sort"
                            name="show_label_sort"
                            [(ngModel)]="form_data.show_label_sort"
                            type="checkbox"
                            checked=""
                            [innerHTML]="show_label_sort ? 'checked' : ''"
                          />
                          <label for="show_label_sort">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SLS' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix" *ngIf="form_data.show_label_sort">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">Set Default Series Dashboard</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <ng-select
                          *ngIf="chartLinks"
                          class="text-light"
                          [items]="chartLinks?.datasource?.metrics"
                          [multiple]="false"
                          [closeOnSelect]="true"
                          [searchable]="true"
                          [hideSelected]="true"
                          bindLabel="verbose_name"
                          bindValue="metric_name"
                          placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SM' | translate }}"
                          name="metrics"
                          [(ngModel)]="form_data.set_default_series"
                        >
                          <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                            <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                              <span class="ng-value-label">{{ item['verbose_name'] }}</span>
                              <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                            </div>
                            <div class="ng-value" *ngIf="items.length > 4">
                              <span class="ng-value-label">{{ items.length - 2 }} more...</span>
                            </div>
                          </ng-template>
                        </ng-select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Pie -->
              <div
                *ngIf="['horizontal_bar', 'dist_bar'].includes(visualType)"
                class="collapse"
                [ngClass]="{ show: activeColapse.chartSortGroup == true }"
              >
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox" *ngIf="chartLinks">
                          <input
                            [(ngModel)]="form_data.pie_sort_asc"
                            name="pie_sort_asc"
                            id="pie_sort_asc"
                            type="checkbox"
                          />
                          <label for="pie_sort_asc">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.SBA' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- X Axis as Date -->
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div
                      class="form-group"
                      *ngIf="
                        ['heatmap', 'dist_bar', 'horizontal_bar'].includes(form_data.viz_type) ||
                        ['heatmap', 'dist_bar', 'horizontal_bar'].includes(visualType)
                      "
                    >
                      <div class="form-line">
                        <div class="checkbox" *ngIf="chartLinks">
                          <input [(ngModel)]="form_data.x_as_date" name="x_as_date" id="x_as_date" type="checkbox" />
                          <label for="x_as_date">X Axis as Date</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Group Chart Margin-->
            <div
              class="collapse-panel"
              *ngIf="
                [
                  'dist_bar',
                  'horizontal_bar',
                  'line',
                  'dual_line',
                  'box_plot',
                  'bubble',
                  'predictive',
                  'scatter'
                ].includes(form_data.viz_type)
              "
            >
              <input class="collapse-check" type="checkbox" id="chck4" />
              <label class="collapse-label" (click)="collapseOnClick('chartMarginGroup')">{{
                'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CHART_MARGIN' | translate
              }}</label>
              <div class="collapse" [ngClass]="{ show: activeColapse.chartMarginGroup == true }">
                <!-- Bar, Line, Boxplot -->
                <div
                  *ngIf="
                    ['dist_bar', 'horizontal_bar', 'line', 'dual_line', 'box_plot'].includes(form_data.viz_type) ||
                    ['dist_bar', 'horizontal_bar', 'line', 'dual_line', 'box_plot'].includes(visualType)
                  "
                >
                  <div class="row clearfix">
                    <div class="col-sm-12 form-control-label">
                      <div class="form-group">
                        <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.BM' | translate }}</label>
                        <div class="form-line">
                          <select
                            *ngIf="chartLinks"
                            class="form-control show-tick ms select2"
                            [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                            [(ngModel)]="form_data.bottom_margin"
                            name="bottom_margin"
                          >
                            <option [value]="null">
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Bottom Margin
                            </option>
                            <option *ngFor="let row of list_bottom_margin | keyvalue" [value]="row.value[1]">
                              {{ row.value[1] }}
                            </option>
                          </select>
                        </div>
                      </div>
                      <div
                        *ngIf="
                          ['horizontal_bar', 'line', 'box_plot'].includes(form_data.viz_type) ||
                          ['horizontal_bar', 'line', 'box_plot'].includes(visualType)
                        "
                        class="form-group"
                      >
                        <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LM' | translate }} </label>
                        <div class="form-line">
                          <select
                            *ngIf="chartLinks"
                            class="form-control show-tick ms select2"
                            [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                            [(ngModel)]="form_data.left_margin"
                            name="left_margin"
                          >
                            <option [value]="null">
                              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Left Margin
                            </option>
                            <option *ngFor="let row of list_bottom_margin | keyvalue" [value]="row.value[1]">
                              {{ row.value[1] }}
                            </option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Bubble & Predictive & Scatter-->
                <div
                  *ngIf="
                    ['bubble', 'predictive', 'scatter'].includes(form_data.viz_type) ||
                    ['bubble', 'predictive', 'scatter'].includes(visualType)
                  "
                >
                  <div class="row clearfix">
                    <div class="col-sm-12 form-control-label">
                      <div class="form-group">
                        <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LM' | translate }} </label>
                        <div class="form-line">
                          <select
                            *ngIf="chartLinks"
                            class="form-control show-tick ms select2"
                            [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                            [(ngModel)]="form_data.left_margin"
                            name="left_margin"
                          >
                            <option *ngFor="let row of list_bottom_margin | keyvalue" [value]="row.value[1]">
                              {{ row.value[1] }}
                            </option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row clearfix">
                    <div class="col-sm-12 form-control-label">
                      <div class="form-group">
                        <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.BM' | translate }} </label>
                        <div class="form-line">
                          <select
                            *ngIf="chartLinks"
                            class="form-control show-tick ms select2"
                            [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                            [(ngModel)]="form_data.bottom_margin"
                            name="bottom_margin"
                          >
                            <option *ngFor="let row of list_bottom_margin | keyvalue" [value]="row.value[1]">
                              {{ row.value[1] }}
                            </option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Group Dual Axis-->
            <div class="collapse-panel" *ngIf="['horizontal_bar', 'dist_bar'].includes(visualType)">
              <input class="collapse-check" type="checkbox" id="chck5" />
              <label class="collapse-label" (click)="collapseOnClick('dualAxisGroup')">Dual Axis</label>
              <div class="collapse" [ngClass]="{ show: activeColapse.dualAxisGroup == true }">
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.show_dual_axis_line"
                            name="show_dual_axis_line"
                            id="show_dual_axis_line"
                            type="checkbox"
                          />
                          <label for="show_dual_axis_line">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SDAL' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Group Chart Label -->
            <div
              class="collapse-panel"
              *ngIf="
                [
                  'heatmap',
                  'horizontal_bar',
                  'dist_bar',
                  'pie',
                  'line',
                  'dual_line',
                  'box_plot',
                  'histogram',
                  'bubble',
                  'directed_force',
                  'gauge',
                  'big_number_total',
                  'map',
                  'country_map',
                  'country_map2',
                  'predictive',
                  'scatter',
                  'sunburst'
                ].includes(visualType)
              "
            >
              <input class="collapse-check" type="checkbox" id="chck6" />
              <label class="collapse-label" (click)="collapseOnClick('chartLabelGroup')">{{
                'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CL' | translate
              }}</label>
              <!-- Heatmap -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.chartLabelGroup == true }"
                *ngIf="['heatmap'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox" *ngIf="chartLinks">
                          <input
                            id="show_label"
                            name="show_label"
                            [(ngModel)]="form_data.show_label"
                            type="checkbox"
                            checked=""
                            [innerHTML]="show_label ? 'checked' : ''"
                          />
                          <label for="show_label">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SL' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Bar -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.chartLabelGroup == true }"
                *ngIf="['horizontal_bar', 'dist_bar'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">X Axis Label </label>
                      <div class="form-line">
                        <input
                          (input)="onReduceChange($any($event))"
                          class="form-control"
                          type="text"
                          name="x_axis_label"
                          [(ngModel)]="form_data.x_axis_label"
                          name="x_axis_label"
                        />
                      </div>
                    </div>
                    <div class="form-group">
                      <label for="last_run">Y Axis Label </label>
                      <div class="form-line">
                        <input
                          (input)="onExtraChange($any($event))"
                          class="form-control"
                          type="text"
                          name="y_axis_label"
                          [(ngModel)]="form_data.y_axis_label"
                          name="y_axis_label"
                        />
                      </div>
                    </div>
                    <div class="form-group" *ngIf="!['heatmap'].includes(visualType)">
                      <label for="last_run">Y Axis Label Line </label>
                      <div class="form-line">
                        <input
                          class="form-control"
                          type="text"
                          name="y_axis_line"
                          [(ngModel)]="form_data.y_axis_line"
                          name="y_axis_line"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Pie -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.chartLabelGroup == true }"
                *ngIf="['pie'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LT' | translate }}</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.pie_label_type"
                          name="pie_label_type"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CLT' | translate }}
                          </option>
                          <option *ngFor="let row of list_pie_label_type | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="checkbox">
                      <input
                        [(ngModel)]="form_data.labels_outside"
                        name="labels_outside"
                        id="labels_outside"
                        type="checkbox"
                      />
                      <label for="labels_outside">{{
                        'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.PLO' | translate
                      }}</label>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="checkbox">
                      <input [(ngModel)]="form_data.hide_label" name="hide_label" id="hide_label" type="checkbox" />
                      <label for="hide_label">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.HL' | translate }}</label>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Line & Boxplot -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.chartLabelGroup == true }"
                *ngIf="['line', 'dual_line', 'box_plot', 'histogram'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">X Axis Label </label>
                      <div class="form-line">
                        <input
                          class="form-control"
                          type="text"
                          name="x_axis_label"
                          [(ngModel)]="form_data.x_axis_label"
                          name="x_axis_label"
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">Y Axis Label </label>
                      <div class="form-line">
                        <input
                          class="form-control"
                          type="text"
                          name="y_axis_label"
                          [(ngModel)]="form_data.y_axis_label"
                          name="y_axis_label"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Bubble -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.chartLabelGroup == true }"
                *ngIf="['bubble'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">X Axis Label </label>
                      <div class="form-line">
                        <input
                          class="form-control"
                          type="text"
                          name="x_axis_label"
                          [(ngModel)]="form_data.x_axis_label"
                          name="x_axis_label"
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <div class="form-group">
                      <label for="last_run">Y Axis Label </label>
                      <div class="form-line">
                        <input
                          class="form-control"
                          type="text"
                          name="y_axis_label"
                          [(ngModel)]="form_data.y_axis_label"
                          name="y_axis_label"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Directed Force -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.chartLabelGroup == true }"
                *ngIf="['directed_force'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input [(ngModel)]="form_data.show_label" name="show_label" id="show_label" type="checkbox" />
                          <label for="show_label">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SL' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Gauge -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.chartLabelGroup == true }"
                *ngIf="['gauge'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input [(ngModel)]="form_data.show_label" name="show_label" id="show_label" type="checkbox" />
                          <label for="show_label">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SL' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.show_axis_label"
                            name="show_axis_label"
                            id="show_axis_label"
                            type="checkbox"
                          />
                          <label for="show_axis_label"
                            >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SAL' | translate }}
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LT' | translate }}</label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.gauge_label_type"
                          name="pie_label_type"
                        >
                          <option [value]="null">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CLT' | translate }}
                          </option>
                          <option *ngFor="let row of list_gauge_label_type | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Big Number -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.chartLabelGroup == true }"
                *ngIf="['big_number_total'].includes(visualType)"
              >
                <div class="form-horizontal">
                  <div class="row clearfix">
                    <div class="col-sm-12 form-control-label">
                      <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LN' | translate }}</label>
                    </div>
                    <div class="col-sm-12">
                      <div class="form-group">
                        <div class="form-line">
                          <input
                            class="form-control"
                            type="text"
                            name="label name"
                            placeholder="label name"
                            [(ngModel)]="form_data.subheader"
                          />
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row clearfix">
                    <div class="col-sm-12 form-control-label">
                      <label for="last_run" class="mb-0"
                        >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LP' | translate }}
                      </label>
                    </div>
                    <div class="col-sm-12 mb-2">
                      <button
                        [ngClass]="
                          form_data.label_position == 'left'
                            ? 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini active ml-0'
                            : 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini ml-0'
                        "
                        (click)="setLabelPosition('left')"
                        data-toggle="tooltip"
                        data-placement="bottom"
                        title=""
                        data-original-title="Label Align Left"
                      >
                        <img src="./assets/images/v_left.svg" width="10" height="10" alt="Label Align Left" />
                      </button>

                      <button
                        [ngClass]="
                          form_data.label_position == 'right'
                            ? 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini active'
                            : 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini'
                        "
                        (click)="setLabelPosition('right')"
                        data-toggle="tooltip"
                        data-placement="bottom"
                        title=""
                        data-original-title="Label Align Right"
                      >
                        <img src="./assets/images/v_right.svg" width="10" height="10" alt="Label Align Right" />
                      </button>

                      <button
                        [ngClass]="
                          form_data.label_position == 'top'
                            ? 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini active'
                            : 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini'
                        "
                        (click)="setLabelPosition('top')"
                        data-toggle="tooltip"
                        data-placement="bottom"
                        title=""
                        data-original-title="Label Align Top"
                      >
                        <img src="./assets/images/v_top.svg" width="10" height="10" alt="Label Align Top" />
                      </button>

                      <button
                        [ngClass]="
                          form_data.label_position == 'bottom'
                            ? 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini active'
                            : 'btn btn-info btn-outline btn-icon btn-sm btn-outline-mini'
                        "
                        (click)="setLabelPosition('bottom')"
                        data-toggle="tooltip"
                        data-placement="bottom"
                        title=""
                        data-original-title="Label Align Bottom"
                      >
                        <img src="./assets/images/v_bottom.svg" width="10" height="10" alt="Label Align Bottom" />
                      </button>
                    </div>
                  </div>
                  <div class="row clearfix">
                    <div class="col-sm-12 form-control-label">
                      <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LFS' | translate }}</label>
                    </div>
                    <div class="col-sm-12">
                      <div class="form-group">
                        <div class="form-line">
                          <input
                            class="form-control"
                            type="text"
                            name="subheaderfontsize"
                            placeholder="subheaderfontsize"
                            [(ngModel)]="form_data.subheaderfontsize"
                            inputNumber
                          />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Map -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.chartLabelGroup == true }"
                *ngIf="['map', 'country_map', 'country_map2'].includes(visualType)"
              >
                <div *ngIf="visualType != 'country_map2'" class="row clearfix">
                  <div class="col-sm-12">
                    <div class="checkbox">
                      <input [(ngModel)]="form_data.hide_label" name="hide_label" id="hide_label" type="checkbox" />
                      <label for="hide_label">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.HL' | translate }}</label>
                    </div>
                  </div>
                </div>
                <div *ngIf="visualType == 'country_map2'" class="row clearfix">
                  <div class="col-sm-12">
                    <div class="checkbox">
                      <input [(ngModel)]="form_data.hide_label" name="hide_label" id="hide_label" type="checkbox" />
                      <label for="hide_label">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.HL' | translate }}</label>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Predictive -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.chartLabelGroup == true }"
                *ngIf="['predictive', 'scatter'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12 form-control-label">
                    <label for="last_run">X Axis Label </label>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <input
                          class="form-control"
                          type="text"
                          name="x_axis_label"
                          [(ngModel)]="form_data.x_axis_label"
                          name="x_axis_label"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Sunburst  -->
              <div
                class="collapse"
                [ngClass]="{ show: activeColapse.chartLabelGroup == true }"
                *ngIf="['sunburst'].includes(visualType)"
              >
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="checkbox">
                      <input [(ngModel)]="form_data.hide_label" name="hide_label" id="hide_label" type="checkbox" />
                      <label for="hide_label">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.HL' | translate }}</label>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="checkbox">
                      <input
                        [(ngModel)]="form_data.labels_outside"
                        name="labels_outside"
                        id="labels_outside"
                        type="checkbox"
                      />
                      <label for="labels_outside">{{
                        'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.PLO' | translate
                      }}</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Group Chart Legend -->
            <div
              class="collapse-panel"
              *ngIf="
                [
                  'dist_bar',
                  'horizontal_bar',
                  'line',
                  'dual_line',
                  'pie',
                  'treemap',
                  'directed_force',
                  'bubble',
                  'country_map',
                  'box_plot',
                  'heatmap'
                ].includes(visualType)
              "
            >
              <input class="collapse-check" type="checkbox" id="chck7" />
              <label class="collapse-label" (click)="collapseOnClick('chartLagendGroup')">{{
                'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CHART_LEGEND' | translate
              }}</label>
              <div class="collapse" [ngClass]="{ show: activeColapse.chartLagendGroup == true }">
                <!-- Show Row Limit -->
                <div
                  *ngIf="['directed_force'].includes(form_data.viz_type) || ['directed_force'].includes(visualType)"
                  class="row clearfix"
                >
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.show_row_limit"
                            name="show_row_limit"
                            id="show_row_limit"
                            type="checkbox"
                          />
                          <label for="show_row_limit">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SHOW_ROW_LIMIT' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Show Legend Bar Chart -->
                <div
                  *ngIf="
                    [
                      'dist_bar',
                      'horizontal_bar',
                      'line',
                      'dual_line',
                      'pie',
                      'treemap',
                      'directed_force',
                      'bubble',
                      'country_map',
                      'box_plot'
                    ].includes(form_data.viz_type) ||
                    [
                      'dist_bar',
                      'horizontal_bar',
                      'line',
                      'dual_line',
                      'pie',
                      'treemap',
                      'directed_force',
                      'bubble',
                      'country_map',
                      'box_plot'
                    ].includes(visualType)
                  "
                  class="row clearfix"
                >
                  <div class="col-sm-12">
                    <div class="form-group">
                      <div class="form-line">
                        <div class="checkbox">
                          <input
                            [(ngModel)]="form_data.show_legend"
                            name="show_legend"
                            id="show_legend"
                            type="checkbox"
                          />
                          <label for="show_legend">{{
                            'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SHOW_LEGEND' | translate
                          }}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div
                  *ngIf="
                    ![
                      'gauge',
                      'big_number_total',
                      'country_map',
                      'filter_box',
                      'markup',
                      'pivot_table',
                      'table',
                      'treemap',
                      'predictive',
                      'scatter',
                      'word_cloud',
                      'table_comparison',
                      'dual_line',
                      'histogram'
                    ].includes(form_data.viz_type) ||
                    ![
                      'gauge',
                      'big_number_total',
                      'country_map',
                      'filter_box',
                      'markup',
                      'pivot_table',
                      'table',
                      'treemap',
                      'predictive',
                      'scatter',
                      'word_cloud',
                      'table_comparison',
                      'dual_line',
                      'histogram'
                    ].includes(visualType)
                  "
                >
                  <!-- Legend Orientation -->
                  <div class="row clearfix">
                    <div class="col-sm-12 form-control-label">
                      <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LO' | translate }}</label>
                    </div>
                    <div class="col-sm-12">
                      <div class="form-group">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.legend_orient"
                          name="legend_orient"
                        >
                          <option *ngFor="let row of list_legend_orient | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <!-- Legend Alignment -->
                  <div class="row clearfix">
                    <div class="col-sm-12 form-control-label">
                      <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LA' | translate }}</label>
                    </div>
                    <div class="pl-2">
                      <div class="form-group">
                        <button
                          [ngClass]="
                            form_data.legend_position == 'left'
                              ? 'btn btn-info btn-outline btn-sm active'
                              : 'btn btn-info btn-outline btn-sm'
                          "
                          (click)="setLegendPosition('left')"
                          data-toggle="tooltip"
                          data-placement="bottom"
                          title=""
                          data-original-title="Align Left"
                        >
                          <img src="./assets/images/v_left.svg" width="10" height="10" alt="Align Left" />
                        </button>

                        <button
                          [ngClass]="
                            form_data.legend_position == 'right'
                              ? 'btn btn-info btn-outline btn-sm active'
                              : 'btn btn-info btn-outline btn-sm'
                          "
                          (click)="setLegendPosition('right')"
                          data-toggle="tooltip"
                          data-placement="bottom"
                          title=""
                          data-original-title="Align Right"
                        >
                          <img src="./assets/images/v_right.svg" width="10" height="10" alt="Align Right" />
                        </button>

                        <button
                          [ngClass]="
                            form_data.legend_position == 'top'
                              ? 'btn btn-info btn-outline btn-sm active'
                              : 'btn btn-info btn-outline btn-sm'
                          "
                          (click)="setLegendPosition('top')"
                          data-toggle="tooltip"
                          data-placement="bottom"
                          title=""
                          data-original-title="Align Top"
                        >
                          <img src="./assets/images/v_top.svg" width="10" height="10" alt="Align Top" />
                        </button>

                        <button
                          [ngClass]="
                            form_data.legend_position == 'bottom'
                              ? 'btn btn-info btn-outline btn-sm active'
                              : 'btn btn-info btn-outline btn-sm'
                          "
                          (click)="setLegendPosition('bottom')"
                          data-toggle="tooltip"
                          data-placement="bottom"
                          title=""
                          data-original-title="Align Bottom"
                        >
                          <img src="./assets/images/v_bottom.svg" width="10" height="10" alt="Align Bottom" />
                        </button>
                      </div>
                    </div>
                  </div>
                  <!-- Legend Type -->
                  <div class="row clearfix">
                    <div class="col-sm-12 form-control-label">
                      <label for="last_run">{{
                        'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LEGEND_TYPE' | translate
                      }}</label>
                    </div>
                    <div class="col-sm-12">
                      <div class="form-group">
                        <select
                          *ngIf="chartLinks"
                          class="form-control show-tick ms select2"
                          [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                          [(ngModel)]="form_data.legend_type"
                          name="legend_type"
                        >
                          <option *ngFor="let row of list_legend_type | keyvalue" [value]="row.value[0]">
                            {{ row.value[1] }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <!-- Legend Width -->
                  <div class="row clearfix">
                    <div class="col-sm-12 form-control-label">
                      <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.LW' | translate }}</label>
                    </div>
                    <div class="col-sm-12">
                      <div class="form-group">
                        <input
                          class="form-control"
                          type="text"
                          name="legend_width"
                          inputmode="numeric"
                          pattern="[0-9]*"
                          [(ngModel)]="form_data.legend_width"
                          name="legend_width"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Group Filter on Chart -->
            <div
              class="collapse-panel"
              *ngIf="
                [
                  'dist_bar',
                  'markup',
                  'horizontal_bar',
                  'line',
                  'dual_line',
                  'pie',
                  'directed_force',
                  'bubble',
                  'country_map',
                  'box_plot',
                  'heatmap',
                  'sunburst',
                  'big_number_total',
                  'gauge',
                  'table',
                  'word_cloud'
                ].includes(visualType)
              "
            >
              <input class="collapse-check" type="checkbox" id="chck8" />
              <label class="collapse-label" (click)="collapseOnClick('chartFilterGroup')">{{
                'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.FOC' | translate
              }}</label>
              <div class="collapse" [ngClass]="{ show: activeColapse.chartFilterGroup == true }">
                <div
                  *ngIf="
                    ![
                      'filter_box',
                      'markup',
                      'pivot_table',
                      'treemap',
                      'predictive',
                      'scatter',
                      'table_comparison',
                      'histogram'
                    ].includes(form_data.viz_type) ||
                    ![
                      'filter_box',
                      'markup',
                      'pivot_table',
                      'treemap',
                      'predictive',
                      'scatter',
                      'table_comparison',
                      'histogram'
                    ].includes(visualType)
                  "
                >
                  <div
                    class="row clearfix"
                    *ngIf="visualType == 'big_number_total' || form_data.viz_type == 'big_number_total'"
                  >
                    <div class="col-md-12">
                      <div class="checkbox">
                        <input
                          id="is_filterable"
                          type="checkbox"
                          checked=""
                          [(ngModel)]="form_data.is_filterable"
                          [innerHTML]="is_filterable ? 'checked' : ''"
                        />
                        <label for="is_filterable">Filterable</label>
                      </div>
                    </div>
                  </div>
                  <!-- Specific one column -->
                  <div
                    *ngIf="
                      ![
                        'filter_box',
                        'markup',
                        'pivot_table',
                        'treemap',
                        'predictive',
                        'scatter',
                        'word_cloud',
                        'table_comparison'
                      ].includes(form_data.viz_type) ||
                      ![
                        'filter_box',
                        'markup',
                        'pivot_table',
                        'treemap',
                        'predictive',
                        'scatter',
                        'word_cloud',
                        'table_comparison'
                      ].includes(visualType)
                    "
                  >
                    <div class="row clearfix">
                      <div class="col-md-12">
                        <div class="checkbox">
                          <input
                            id="checkbox2"
                            type="checkbox"
                            checked=""
                            [(ngModel)]="form_data.chart_on_click"
                            [innerHTML]="chart_on_click ? 'checked' : ''"
                          />
                          <label for="checkbox2">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.COC' | translate }}
                          </label>
                        </div>
                      </div>
                    </div>
                    <div class="row clearfix" *ngIf="form_data.chart_on_click">
                      <div class="col-sm-12">
                        <div class="form-group">
                          <div class="form-line">
                            <ng-select
                              class="text-light"
                              [items]="dashboardList"
                              [multiple]="false"
                              [closeOnSelect]="true"
                              [searchable]="true"
                              bindLabel="dashboard_title"
                              bindValue="slug"
                              placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Dashboard"
                              [(ngModel)]="form_data.link_to"
                              [ngModelOptions]="{ standalone: true }"
                            >
                              <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                                <div class="ng-value" *ngFor="let item of items">
                                  <span class="ng-value-label">
                                    {{ item.dashboard_title }}
                                  </span>
                                </div>
                              </ng-template>
                            </ng-select>
                          </div>
                        </div>
                      </div>
                      <!-- <div class="col-md-12">
                                        <div class="form-group">
                                            <select class="form-control show-tick ms select2" data-placeholder={{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate }}" [(ngModel)]="form_data.link_to">
                                                <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} One</option>
                                                <option *ngFor="let row of dashboardList" [value]="row.slug">{{ row.dashboard_title }}</option>
                                            </select>
                                        </div>
                                    </div> -->
                      <div class="col-md-12" *ngIf="visualType == 'table' && form_data.chart_on_click">
                        <div class="checkbox">
                          <input
                            id="chart_on_click_specific_col"
                            type="checkbox"
                            checked=""
                            [(ngModel)]="form_data.chart_on_click_specific_col"
                          />
                          <label for="chart_on_click_specific_col">
                            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SOC' | translate }}
                          </label>
                        </div>
                        <div
                          class="row clearfix"
                          *ngIf="visualType == 'table' && form_data.chart_on_click_specific_col"
                        >
                          <div class="col-md-12">
                            <div class="form-group">
                              <select
                                class="form-control show-tick ms select2"
                                [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                                [(ngModel)]="form_data.chart_on_click_col"
                              >
                                <option [value]="null">
                                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CHOSE_COL' | translate }}
                                </option>
                                <option *ngFor="let col of chartLinks?.datasource?.columns" [value]="col.column_name">
                                  {{ col.column_name }}
                                </option>
                              </select>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- /Specific one column -->
                  <div class="row clearfix">
                    <div class="col-md-12">
                      <div class="checkbox">
                        <input
                          id="is_hide_togle_filter"
                          type="checkbox"
                          checked=""
                          [(ngModel)]="form_data.is_hide_togle_filter"
                          [innerHTML]="is_hide_togle_filter ? 'checked' : ''"
                        />
                        <label for="is_hide_togle_filter">
                          {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.HTF' | translate }}
                        </label>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row clearfix">
                  <div class="col-md-12">
                    <div class="checkbox">
                      <input
                        id="initial_chart_blank"
                        type="checkbox"
                        checked=""
                        [(ngModel)]="form_data.initial_chart_blank"
                        [innerHTML]="initial_chart_blank ? 'checked' : ''"
                      />
                      <label for="initial_chart_blank">
                        {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.ICB' | translate }}
                      </label>
                    </div>
                  </div>
                </div>
                <div
                  *ngIf="
                    form_data.chart_on_click &&
                    (['big_number_total'].includes(form_data.viz_type) || ['big_number_total'].includes(visualType))
                  "
                >
                  <div class="row clearfix">
                    <div class="col-sm-12 form-control-label">
                      <label for="last_run"
                        >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.FIB' | translate }}
                        <font color="red">*</font></label
                      >
                    </div>
                    <div class="col-sm-12">
                      <div class="form-group">
                        <div class="form-line">
                          <ng-select
                            *ngIf="chartLinks"
                            class="text-light"
                            [items]="chartLinks?.datasource?.gb_cols | keyvals"
                            [multiple]="false"
                            [closeOnSelect]="true"
                            [searchable]="true"
                            [hideSelected]="true"
                            bindLabel="value"
                            bindValue="value"
                            placeholder="{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate }} filter item"
                            name="filter_item"
                            [(ngModel)]="form_data.filter_item"
                            [ngClass]="form_data.filter_item == '' ? 'require-error is-invalid' : ''"
                            required
                          >
                            <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                              <div class="ng-value" *ngFor="let item of items | slice: 0:4">
                                <span class="ng-value-label" id="{{ item['key'] }}">
                                  {{ item['value'] }}
                                </span>
                                <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                              </div>
                              <div class="ng-value" *ngIf="items.length > 4">
                                <span class="ng-value-label">{{ items.length - 2 }} more...</span>
                              </div>
                            </ng-template>
                          </ng-select>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row clearfix">
                    <div class="col-sm-12 form-control-label">
                      <label for="last_run"
                        >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.FL' | translate }}
                        <font color="red">*</font></label
                      >
                    </div>
                    <div class="col-sm-12">
                      <div class="form-group">
                        <div class="form-line">
                          <input
                            type="text"
                            class="form-control"
                            placeholder="Input filter label"
                            [(ngModel)]="form_data.filter_label"
                            [ngClass]="form_data.filter_label == '' ? 'require-error is-invalid' : ''"
                            required
                          />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Group Custom Display -->
            <div class="collapse-panel">
              <input class="collapse-check" type="checkbox" id="chck9" />
              <label class="collapse-label" (click)="collapseOnClick('customDisplayGroup')">{{
                'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.CD' | translate
              }}</label>
              <div class="collapse" [ngClass]="{ show: activeColapse.customDisplayGroup == true }">
                <!-- hide title  -->
                <div class="row clearfix">
                  <div class="col-md-12">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="hide_title"
                        name="hide_title"
                        [(ngModel)]="form_data.hide_title"
                        type="checkbox"
                        [innerHTML]="hide_title ? 'checked' : ''"
                      />
                      <label for="hide_title">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.HD' | translate }}</label>
                    </div>
                  </div>
                </div>
                <!-- hide background  -->
                <div class="row clearfix">
                  <div class="col-sm-12">
                    <div class="checkbox" *ngIf="chartLinks">
                      <input
                        id="hide_background"
                        name="hide_background"
                        [(ngModel)]="form_data.hide_background"
                        type="checkbox"
                        [innerHTML]="hide_background ? 'checked' : ''"
                      />
                      <label for="hide_background">{{
                        'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.HB' | translate
                      }}</label>
                    </div>
                  </div>
                </div>
                <!-- hide date picker  -->
                <div class="row clearfix">
                  <div class="col-md-12">
                    <div class="checkbox">
                      <input
                        id="hide_date_picker"
                        type="checkbox"
                        checked=""
                        [(ngModel)]="form_data.hide_date_picker"
                        [innerHTML]="hide_date_picker ? 'checked' : ''"
                      />
                      <label for="hide_date_picker">
                        {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.HDP' | translate }}
                      </label>
                    </div>
                  </div>
                </div>

                <!-- Table Chart -->
                <div class="form-horizontal" *ngIf="form_data.viz_type == 'table'">
                  <!-- Font Size Table Chart -->
                  <div class="row clearfix mt-2">
                    <div class="col-sm-12 form-control-label">
                      <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.FS' | translate }}</label>
                    </div>
                    <div class="col-sm-12">
                      <div class="form-group">
                        <div class="form-line">
                          <input
                            class="form-control"
                            type="text"
                            name="tableFontSize"
                            placeholder="font size"
                            [(ngModel)]="form_data.table_font_size"
                            inputNumber
                          />
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- Font Type Table Chart -->
                  <div class="row clearfix mt-2">
                    <div class="col-sm-12 form-control-label">
                      <div class="form-group">
                        <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.FT' | translate }}</label>
                        <div class="form-line">
                          <select
                            *ngIf="chartLinks"
                            class="form-control show-tick ms select2"
                            [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                            [(ngModel)]="form_data.table_font_family"
                            name="table_font_type"
                          >
                            <option [value]="null">Default</option>
                            <option *ngFor="let row of fontFamilyList | keyvalue" [value]="row.value[0]">
                              {{ row.value[1] }}
                            </option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- Show Total Value Table Chart -->
                  <div class="row clearfix">
                    <div class="col-sm-12">
                      <div class="form-group">
                        <div class="form-line">
                          <div class="checkbox">
                            <input
                              [(ngModel)]="form_data.show_total_numeric_column"
                              name="show_total_numeric_column"
                              id="show_total_numeric_column"
                              type="checkbox"
                            />
                            <label for="show_total_numeric_column">{{
                              'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.STV' | translate
                            }}</label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- Search Box Table Chart -->
                  <div class="row clearfix">
                    <div class="col-sm-12">
                      <div class="form-group">
                        <div class="form-line">
                          <div class="checkbox" *ngIf="chartLinks">
                            <input
                              [(ngModel)]="form_data.include_search"
                              name="include_search"
                              id="include_search"
                              type="checkbox"
                            />
                            <label for="include_search">{{
                              'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SB' | translate
                            }}</label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- Search Multi Columns Table Chart -->
                  <div class="row clearfix">
                    <div class="col-sm-12">
                      <div class="form-group">
                        <div class="form-line">
                          <div class="checkbox" *ngIf="chartLinks">
                            <input
                              [(ngModel)]="form_data.search_multi_columns"
                              name="search_multi_columns"
                              id="search_multi_columns"
                              type="checkbox"
                            />
                            <label for="search_multi_columns">{{
                              'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.SMC' | translate
                            }}</label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- Display Static Number Table Chart -->
                  <div class="row clearfix">
                    <div class="col-sm-12">
                      <div class="form-group">
                        <div class="form-line">
                          <div class="checkbox">
                            <input
                              [(ngModel)]="form_data.static_number"
                              name="static_number"
                              id="static_number"
                              type="checkbox"
                            />
                            <label for="static_number">{{
                              'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.OPTIONS.DSN' | translate
                            }}</label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- GLOBAL -->
            <div
              *ngIf="
                (![
                  'filter_box',
                  'markup',
                  'directed_force',
                  'pivot_table',
                  'treemap',
                  'predictive',
                  'scatter',
                  'word_cloud',
                  'table_comparison'
                ].includes(form_data.viz_type) ||
                  ![
                    'filter_box',
                    'markup',
                    'directed_force',
                    'pivot_table',
                    'treemap',
                    'predictive',
                    'scatter',
                    'word_cloud',
                    'table_comparison'
                  ].includes(visualType)) &&
                form_data.chart_on_click
              "
            >
              <div *ngIf="['country_map'].includes(form_data.viz_type) || ['country_map'].includes(visualType)">
                <div class="form-control-label">
                  <label for="last_run">Link Reference <font color="red">*</font></label>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.map_label_reference"
                      name="map_label_reference"
                      [ngClass]="form_data.map_label_reference == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.CD' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.filterable_cols | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[0] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Time For Filter Box & Markup -->
    <div
      class="panel panel-primary m-0"
      *ngIf="['filter_box', 'markup'].includes(form_data.viz_type) || ['filter_box', 'markup'].includes(visualType)"
    >
      <div class="panel-heading" role="tab" id="headingFour_1">
        <h4 class="panel-title">
          <a
            [ngClass]="{ toggled: activeColapse.filter == true }"
            class="menu-toggle collapsed text-uppercase"
            role="button"
            (click)="collapseOnClick('filter')"
            ><i
              class="zmdi zmdi-info"
              data-toggle="popover"
              data-placement="bottom"
              [attr.data-original-title]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.LABEL' | translate"
              [attr.data-content]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.LABEL_TOOLTIP' | translate"
            ></i
            >&nbsp;
            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.LABEL' | translate }}
          </a>
        </h4>
      </div>
      <div [ngClass]="{ show: activeColapse.filter == true }" class="panel-collapse collapse" role="tabpanel">
        <div class="panel-body">
          <div class="form-horizontal">
            <div
              *ngIf="
                visualType != 'table' &&
                !['line', 'dual_line'].includes(form_data.viz_type) &&
                form_data.viz_type2 == undefined
              "
              class="row clearfix"
            >
              <div class="col-sm-12">
                <div class="form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.TC' | translate }}</label>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.granularity_sqla"
                      name="granularity_sqla"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.CTC' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.granularity_sqla | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.TG' | translate }} </label>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.time_grain_sqla"
                      name="time_grain_sqla"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.CTG' | translate }}</option>
                      <option *ngFor="let row of list_time_grain_sqla | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12">
                <div class="form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.S' | translate }} </label>
                </div>
                <mat-form-field appearance="fill">
                  <mat-label></mat-label>
                  <input
                    type="text"
                    name="since"
                    matInput
                    [matDatepicker]="since"
                    placeholder="{{ 'MODULE.DATA_VISUAL.CHART.VALIDATOR.CDS' | translate }}"
                    class="form-control datepicker"
                    [value]="form_data.since"
                    (dateChange)="setPicker($event, 'since')"
                  />
                  <mat-datepicker-toggle matPrefix [for]="since"></mat-datepicker-toggle>
                  <mat-datepicker #since> </mat-datepicker>
                </mat-form-field>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-sm-12">
                <div class="form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.U' | translate }} </label>
                </div>
                <mat-form-field appearance="fill">
                  <mat-label></mat-label>
                  <input
                    type="text"
                    name="until"
                    matInput
                    [matDatepicker]="until"
                    placeholder="{{ 'MODULE.DATA_VISUAL.CHART.VALIDATOR.CDU' | translate }}"
                    class="form-control datepicker"
                    [value]="form_data.until"
                    (dateChange)="setPicker($event, 'until')"
                  />
                  <mat-datepicker-toggle matPrefix [for]="until"></mat-datepicker-toggle>
                  <mat-datepicker #until> </mat-datepicker>
                </mat-form-field>
              </div>
            </div>
            <div class="row clearfix" *ngIf="visualType != 'filter_box'">
              <div class="col-sm-12">
                <div class="form-control-label">
                  <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.DF' | translate }}</label>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.filter_date"
                      name="granularity_sqla"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.VALIDATOR.CFD' | translate }}</option>
                      <option *ngFor="let row of filterDateList | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="col-sm-12">
                <div class="form-control-label">
                  <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.DFT' | translate }}</label>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.filter_date_type"
                      (change)="onChangeFilterComparison(form_data.filter_date_type)"
                      name="granularity_sqla"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.VALIDATOR.SDFT' | translate }}</option>
                      <option *ngFor="let row of filterDateTypeList | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="col-sm-12">
                <div
                  class="form-control-label"
                  *ngIf="
                    data_exploreJson?.form_data?.granularity_sqla !== undefined &&
                    data_exploreJson?.form_data?.granularity_sqla !== '' &&
                    data_exploreJson?.form_data?.granularity_sqla !== null
                  "
                >
                  <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.IDF' | translate }}</label>
                </div>
                <div
                  class="form-group"
                  *ngIf="
                    data_exploreJson?.form_data?.granularity_sqla !== undefined &&
                    data_exploreJson?.form_data?.granularity_sqla !== '' &&
                    data_exploreJson?.form_data?.granularity_sqla !== null
                  "
                >
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.initial_date_filter"
                      name="granularity_sqla"
                    >
                      <option [value]="null">Default</option>
                      <option *ngFor="let row of initialFilterDateList | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Time For Bukan Filter Box & Markup -->
    <div
      class="panel panel-primary m-0"
      *ngIf="!['filter_box', 'markup'].includes(form_data.viz_type) || !['filter_box', 'markup'].includes(visualType)"
    >
      <div class="panel-heading" role="tab" id="headingFour_1">
        <h4 class="panel-title">
          <a
            [ngClass]="{ toggled: activeColapse.time == true }"
            class="menu-toggle collapsed text-uppercase"
            role="button"
            (click)="collapseOnClick('time')"
            ><i
              class="zmdi zmdi-info"
              data-toggle="popover"
              data-placement="bottom"
              [attr.data-original-title]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.LABEL' | translate"
              [attr.data-content]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.LABEL_TOOLTIP' | translate"
            ></i
            >&nbsp;
            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.LABEL' | translate }}
          </a>
        </h4>
      </div>
      <div [ngClass]="{ show: activeColapse.time == true }" class="panel-collapse collapse" role="tabpanel">
        <div class="panel-body">
          <div class="form-horizontal">
            <div *ngIf="visualType == 'table'" class="row clearfix">
              <div class="col-lg-12">
                <div class="form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.TC' | translate }} </label>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.granularity_sqla"
                      name="granularity_sqla"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.CTC' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.granularity_sqla | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
                <div class="form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.TG' | translate }} </label>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.time_grain_sqla"
                      name="time_grain_sqla"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.CTG' | translate }}</option>
                      <option *ngFor="let row of list_time_grain_sqla | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div
              *ngIf="
                visualType != 'table' &&
                !['line', 'dual_line'].includes(form_data.viz_type) &&
                form_data.viz_type2 == undefined
              "
              class="row clearfix"
            >
              <div class="col-lg-12">
                <div class="form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.TC' | translate }} </label>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.granularity_sqla"
                      name="granularity_sqla"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.CTC' | translate }}</option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.granularity_sqla | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.TG' | translate }} </label>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.time_grain_sqla"
                      name="time_grain_sqla"
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.CTG' | translate }}</option>
                      <option *ngFor="let row of list_time_grain_sqla | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div
              *ngIf="
                ['line', 'dual_line', 'predictive', 'box_plot'].includes(form_data.viz_type) ||
                form_data.viz_type2 == 'predictive'
              "
              class="row clearfix"
            >
              <div class="col-lg-12">
                <div class="form-control-label">
                  <label for="last_run"
                    >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.TC' | translate }}
                    <font color="red">*</font>
                  </label>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.granularity_sqla"
                      name="granularity_sqla"
                      [ngClass]="form_data.granularity_sqla == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">
                        {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Time Column
                      </option>
                      <option
                        *ngFor="let row of chartLinks?.datasource?.granularity_sqla | keyvalue"
                        [value]="row.value[0]"
                      >
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="form-control-label">
                  <label for="last_run"
                    >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.TG' | translate }}
                    <font color="red">*</font>
                  </label>
                </div>
                <div class="form-group">
                  <div class="form-line">
                    <select
                      *ngIf="chartLinks"
                      class="form-control show-tick ms select2"
                      [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                      [(ngModel)]="form_data.time_grain_sqla"
                      name="time_grain_sqla"
                      [ngClass]="form_data.time_grain_sqla == '' ? 'require-error is-invalid' : ''"
                      required
                    >
                      <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.CTG' | translate }}</option>
                      <option *ngFor="let row of list_time_grain_sqla | keyvalue" [value]="row.value[0]">
                        {{ row.value[1] }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-lg-12">
                <div class="form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.S' | translate }} </label>
                </div>
                <mat-form-field appearance="fill">
                  <mat-label></mat-label>
                  <input
                    type="text"
                    name="since"
                    matInput
                    [matDatepicker]="since"
                    placeholder="{{ 'MODULE.DATA_VISUAL.CHART.VALIDATOR.CDS' | translate }}"
                    [value]="form_data.since"
                    (dateChange)="setPicker($event, 'since')"
                    class="form-control datepicker"
                  />
                  <mat-datepicker-toggle matPrefix [for]="since"></mat-datepicker-toggle>
                  <mat-datepicker #since> </mat-datepicker>
                </mat-form-field>

                <div class="form-control-label">
                  <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.U' | translate }} </label>
                </div>
                <mat-form-field appearance="fill">
                  <mat-label></mat-label>
                  <input
                    type="text"
                    name="until"
                    matInput
                    [matDatepicker]="until"
                    placeholder="{{ 'MODULE.DATA_VISUAL.CHART.VALIDATOR.CDU' | translate }}"
                    [value]="form_data.until"
                    (dateChange)="setPicker($event, 'until')"
                    class="form-control datepicker"
                  />
                  <mat-datepicker-toggle matPrefix [for]="until"></mat-datepicker-toggle>
                  <mat-datepicker #until> </mat-datepicker>
                </mat-form-field>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-md-12 form-control-label">
                <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.DF' | translate }}</label>
              </div>
              <div class="col-md-12">
                <div class="form-group">
                  <select
                    *ngIf="chartLinks"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                    [(ngModel)]="form_data.filter_date"
                    name="granularity_sqla"
                  >
                    <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.VALIDATOR.CFD' | translate }}</option>
                    <option *ngFor="let row of filterDateList | keyvalue" [value]="row.value[0]">
                      {{ row.value[1] }}
                    </option>
                  </select>
                </div>
              </div>

              <div class="col-md-12 form-control-label">
                <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.DFT' | translate }}</label>
              </div>
              <div class="col-md-12">
                <div class="form-group">
                  <select
                    *ngIf="chartLinks"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                    [(ngModel)]="form_data.filter_date_type"
                    name="granularity_sqla"
                  >
                    <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.VALIDATOR.SDFT' | translate }}</option>
                    <option *ngFor="let row of filterDateTypeList | keyvalue" [value]="row.value[0]">
                      {{ row.value[1] }}
                    </option>
                  </select>
                </div>
              </div>

              <div
                class="col-md-12 form-control-label"
                *ngIf="
                  data_exploreJson?.form_data?.granularity_sqla !== undefined &&
                  data_exploreJson?.form_data?.granularity_sqla !== '' &&
                  data_exploreJson?.form_data?.granularity_sqla !== null
                "
              >
                <label>{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.TIME.IDF' | translate }}</label>
              </div>
              <div
                class="col-md-12"
                *ngIf="
                  data_exploreJson?.form_data?.granularity_sqla !== undefined &&
                  data_exploreJson?.form_data?.granularity_sqla !== '' &&
                  data_exploreJson?.form_data?.granularity_sqla !== null
                "
              >
                <div class="form-group">
                  <select
                    *ngIf="chartLinks"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                    [(ngModel)]="form_data.initial_date_filter"
                    name="granularity_sqla"
                  >
                    <option [value]="null">Default</option>
                    <option *ngFor="let row of initialFilterDateList | keyvalue" [value]="row.value[0]">
                      {{ row.value[1] }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Filter Chart  -->
    <div
      class="panel panel-primary m-0"
      *ngIf="!['markup'].includes(form_data.viz_type) || !['markup'].includes(visualType)"
    >
      <div class="panel-heading" role="tab" id="headingFive_1">
        <h4 class="panel-title">
          <a
            [ngClass]="{ toggled: activeColapse.filter == true }"
            class="menu-toggle collapsed text-uppercase"
            role="button"
            (click)="collapseOnClick('filter')"
            ><i
              class="zmdi zmdi-info"
              data-toggle="popover"
              data-placement="bottom"
              [attr.data-original-title]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.FILTER.LABEL' | translate"
              [attr.data-content]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.FILTER_TOOLTIP' | translate"
            ></i
            >&nbsp;
            {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.FILTER.LABEL' | translate }}
          </a>
        </h4>
      </div>
      <div [ngClass]="{ show: activeColapse.filter == true }" class="panel-collapse collapse" role="tabpanel">
        <div class="panel-body">
          <div class="form-horizontal">
            <button
              type="button"
              class="btn btn-info btn-outline add-filters btn-sm w-100 m-0 mb-3"
              [ngClass]="form_data.viz_type != undefined || stateloadDataset ? '' : '  disabled'"
              (click)="onAddFilters()"
            >
              {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.FILTER.AF' | translate }}
              <i class="zmdi zmdi-plus f-12 ml-1"></i>
            </button>
          </div>

          <!-- <div class="row clearfix" *ngFor="
                    let item of form_data.filters;
                    let i = index;
                    trackBy
                "> -->
          <div class="row clearfix" *ngFor="let item of form_data.filters; let i = index">
            <div class="col-sm-12 form-control-label">
              <label for="last_run">Filter Data {{ i + 1 }}</label>
            </div>
            <div class="col-sm-12">
              <div class="form-group">
                <div class="form-line">
                  <select
                    *ngIf="chartLinks"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                    name="col[]"
                    [(ngModel)]="form_data.filters[i].col"
                  >
                    <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.VALIDATOR.CFD' | translate }}</option>
                    <option *ngFor="let row of chartLinks?.datasource?.filterable_cols | keyvals" [value]="row.value">
                      {{ row.value }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
            <div class="col-sm-12 form-control-label">
              <label for="last_run"
                >{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Operator {{ i + 1 }}</label
              >
            </div>
            <div class="col-sm-12">
              <div class="form-group">
                <div class="form-line">
                  <select
                    *ngIf="chartLinks"
                    class="form-control show-tick ms select2"
                    [attr.data-placeholder]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.QUERY.S' | translate"
                    name="op[i]"
                    [(ngModel)]="form_data.filters[i].op"
                  >
                    <option [value]="null">{{ 'MODULE.DATA_VISUAL.CHART.VALIDATOR.CO' | translate }}</option>
                    <option *ngFor="let row of list_cols | keyvals" [value]="row.value">
                      {{ row.value }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
            <div class="col-sm-12 form-control-label">
              <label for="last_run">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.CH' | translate }} Value {{ i + 1 }}</label>
            </div>
            <div class="col-sm-12">
              <div class="form-group">
                <div class="form-line" *ngIf="['in', 'not in'].includes(form_data.filters[i].op)">
                  <ng-select
                    [items]="form_data.filters[i].val"
                    [addTag]="addTagFn"
                    addTagText="Add Value"
                    [multiple]="true"
                    [closeOnSelect]="true"
                    [searchable]="true"
                    [hideSelected]="true"
                    bindLabel="val"
                    bindValue="val"
                    placeholder="input value"
                    name="val[i]"
                    [(ngModel)]="form_data.filters[i].val"
                  >
                  </ng-select>
                </div>
                <div class="form-line" *ngIf="!['in', 'not in'].includes(form_data.filters[i].op)">
                  <input
                    class="form-control"
                    placeholder="input value"
                    name="val[i]"
                    [(ngModel)]="form_data.filters[i].val"
                  />
                </div>
              </div>
            </div>
            <div class="col-sm-12">
              <div class="form-group">
                <button
                  type="button"
                  class="btn btn-danger del-filters btn-sm w-100 m-0 mt-2 f-10"
                  (click)="onDelFilters(i)"
                >
                  {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.FILTER.D' | translate }}
                  <i class="zmdi zmdi-delete f-12 ml-1"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Notification Alert -->
    <div
      class="panel panel-primary m-0"
      [ngClass]="
        (['table', 'heatmap', 'dist_bar', 'horizontal_bar', 'gauge', 'big_number_total'].includes(form_data.viz_type) ||
          ['table', 'heatmap', 'dist_bar', 'horizontal_bar', 'gauge', 'big_number_total'].includes(visualType)) &&
        environtmentType != 'on_cloud'
          ? ''
          : 'd-none'
      "
    >
      <div class="panel-heading" role="tab" id="headingSeven_1">
        <h4 class="panel-title">
          <a
            [ngClass]="{ toggled: activeColapse.notification == true }"
            class="menu-toggle collapsed text-uppercase"
            role="button"
            (click)="collapseOnClick('notification')"
          >
            <i
              class="zmdi zmdi-info"
              data-toggle="popover"
              data-placement="bottom"
              [attr.data-original-title]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.NOTIFICATIONS' | translate"
              [attr.data-content]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.NOTIFICATIONS_TOOLTIP' | translate"
            ></i
            >&nbsp; {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.NOTIFICATIONS' | translate }}</a
          >
        </h4>
      </div>
      <div [ngClass]="{ show: activeColapse.notification == true }" class="panel-collapse collapse" role="tabpanel">
        <div
          class="panel-body"
          *ngIf="
            [
              'heatmap',
              'dist_bar',
              'horizontal_bar',
              'line',
              'dual_line',
              'bubble',
              'predictive',
              'gauge',
              'big_number_total',
              'country_map',
              'pie',
              'table',
              'table_comparison'
            ].includes(form_data.viz_type) ||
            [
              'heatmap',
              'dist_bar',
              'horizontal_bar',
              'line',
              'dual_line',
              'bubble',
              'predictive',
              'gauge',
              'big_number_total',
              'country_map',
              'pie',
              'table',
              'table_comparison'
            ].includes(visualType)
          "
        >
          <div class="row clearfix">
            <div class="col-sm-12 form-control-label">
              <p class="mb-2">{{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.SNC' | translate }}</p>
            </div>
          </div>
          <div class="row clearfix">
            <div class="col-sm-12 form-control-label">
              <button
                type="button"
                [ngClass]="slice?.slice_id > 0 && slice?.slice_id != undefined ? '' : 'disabled'"
                (click)="
                  slice?.slice_id > 0 && slice?.slice_id != undefined
                    ? openModalTemplateCustom(
                        ['table'].includes(form_data.vis_type) || ['table'].includes(visualType)
                          ? 'formulaModalNotifications'
                          : 'modalNotifications'
                      )
                    : ''
                "
                class="btn btn-info btn-outline btn-sm w-100 m-0"
              >
                {{ 'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.AN' | translate }} <i class="zmdi zmdi-plus f-12 ml-1"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="hide-menu rtl-sidebar" (click)="addRemoveBodyClass('right_icon_toggle', 'right')">
    <div
      class="btn-toggle btn-toggle-menu"
      data-toggle="tooltip"
      data-placement="left"
      [attr.data-original-title]="'MODULE.DATA_VISUAL.CHART.RIGHT_BAR.HIDE' | translate"
    >
      <a href="javascript:void(0);" class="btn-menu"></a>
    </div>
  </div>
</aside>

<!-- Main Content -->
<!-- Disable karena sudah tidak perlu -->
<!-- <section class="content">
  <div class="text-center mt-3 f-12" *ngIf="isViewMessage">
    <p class="mb-0">
      {{ 'MODULE.DATA_VISUAL.CHART.COMMON.CONTENT_LABEL' | translate }}
    </p>
    <p>
      {{ 'MODULE.DATA_VISUAL.CHART.COMMON.CONTENT_LABEL2' | translate }}
    </p>
  </div>
  <div class="row clearfix" *ngIf="isLoadingContent">
    <div class="col-md-12">
      <mat-spinner class="mat-spinner-color" [diameter]="60" style="margin: 0 auto"></mat-spinner>
      <h5 class="f-12 text-center mt-3">{{ 'MODULE.DATA_VISUAL.CHART.COMMON.LC' | translate }}</h5>
    </div>
  </div>
  <div class="row clearfix" *ngIf="!isLoadingContent && slice?.slice_id == 'undefined'">
    <div class="col-md-12">
      <h3>
        {{ datasourceTitle == '' ? 'untitled' : datasourceTitle }}
      </h3>
    </div>
  </div>
  <div class="row clearfix" id="workspace">
    <ng-template [ngIf]="!errors" appInject #noErrors> </ng-template>
  </div>
</section> -->
